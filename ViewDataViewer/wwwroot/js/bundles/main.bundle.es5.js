"use strict";!(function e(t,r,n){function o(s,a){if(!r[s]){if(!t[s]){var c="function" == typeof require && require;if(!a && c)return c(s,!0);if(i)return i(s,!0);var u=new Error("Cannot find module '" + s + "'");throw (u.code = "MODULE_NOT_FOUND",u);}var l=r[s] = {exports:{}};t[s][0].call(l.exports,function(e){return o(t[s][1][e] || e);},l,l.exports,e,t,r,n);}return r[s].exports;}for(var i="function" == typeof require && require,s=0;s < n.length;s++) o(n[s]);return o;})({1:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=(function(){function e(){this.isAborted = !1,this.onabort = null;}return e.prototype.abort = function(){this.isAborted || (this.isAborted = !0,this.onabort && this.onabort());},Object.defineProperty(e.prototype,"signal",{get:function get(){return this;},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"aborted",{get:function get(){return this.isAborted;},enumerable:!0,configurable:!0}),e;})();r.AbortController = n;},{}],2:[function(e,t,r){"use strict";var n,o=this && this.__extends || (n = Object.setPrototypeOf || {__proto__:[]} instanceof Array && function(e,t){e.__proto__ = t;} || function(e,t){for(var r in t) t.hasOwnProperty(r) && (e[r] = t[r]);},function(e,t){function r(){this.constructor = e;}n(e,t),e.prototype = null === t?Object.create(t):(r.prototype = t.prototype,new r());});Object.defineProperty(r,"__esModule",{value:!0});var i=e("./Errors"),s=e("./FetchHttpClient"),a=e("./HttpClient"),c=e("./Utils"),u=e("./XhrHttpClient"),l=(function(e){function t(t){var r=e.call(this) || this;if("undefined" != typeof fetch || c.Platform.isNode)r.httpClient = new s.FetchHttpClient(t);else {if("undefined" == typeof XMLHttpRequest)throw new Error("No usable HttpClient found.");r.httpClient = new u.XhrHttpClient(t);}return r;}return o(t,e),t.prototype.send = function(e){return e.abortSignal && e.abortSignal.aborted?Promise.reject(new i.AbortError()):e.method?e.url?this.httpClient.send(e):Promise.reject(new Error("No url defined.")):Promise.reject(new Error("No method defined."));},t.prototype.getCookieString = function(e){return this.httpClient.getCookieString(e);},t;})(a.HttpClient);r.DefaultHttpClient = l;},{"./Errors":4,"./FetchHttpClient":5,"./HttpClient":7,"./Utils":20,"./XhrHttpClient":22}],3:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=[0,2e3,1e4,3e4,null],o=(function(){function e(e){this.retryDelays = void 0 !== e?e.concat([null]):n;}return e.prototype.nextRetryDelayInMilliseconds = function(e){return this.retryDelays[e.previousRetryCount];},e;})();r.DefaultReconnectPolicy = o;},{}],4:[function(e,t,r){"use strict";var n,o=this && this.__extends || (n = Object.setPrototypeOf || {__proto__:[]} instanceof Array && function(e,t){e.__proto__ = t;} || function(e,t){for(var r in t) t.hasOwnProperty(r) && (e[r] = t[r]);},function(e,t){function r(){this.constructor = e;}n(e,t),e.prototype = null === t?Object.create(t):(r.prototype = t.prototype,new r());});Object.defineProperty(r,"__esModule",{value:!0});var i=(function(e){function t(t,r){var n=this,o=this.constructor.prototype;return (n = e.call(this,t) || this).statusCode = r,n.__proto__ = o,n;}return o(t,e),t;})(Error);r.HttpError = i;var s=(function(e){function t(t){void 0 === t && (t = "A timeout occurred.");var r=this,n=this.constructor.prototype;return (r = e.call(this,t) || this).__proto__ = n,r;}return o(t,e),t;})(Error);r.TimeoutError = s;var a=(function(e){function t(t){void 0 === t && (t = "An abort occurred.");var r=this,n=this.constructor.prototype;return (r = e.call(this,t) || this).__proto__ = n,r;}return o(t,e),t;})(Error);r.AbortError = a;},{}],5:[function(e,t,r){"use strict";var n,o=this && this.__extends || (n = Object.setPrototypeOf || {__proto__:[]} instanceof Array && function(e,t){e.__proto__ = t;} || function(e,t){for(var r in t) t.hasOwnProperty(r) && (e[r] = t[r]);},function(e,t){function r(){this.constructor = e;}n(e,t),e.prototype = null === t?Object.create(t):(r.prototype = t.prototype,new r());}),i=this && this.__assign || Object.assign || function(e){for(var t,r=1,n=arguments.length;r < n;r++) for(var o in t = arguments[r]) Object.prototype.hasOwnProperty.call(t,o) && (e[o] = t[o]);return e;},s=this && this.__awaiter || function(e,t,r,n){return new (r || (r = Promise))(function(o,i){function s(e){try{c(n.next(e));}catch(e) {i(e);}}function a(e){try{c(n["throw"](e));}catch(e) {i(e);}}function c(e){e.done?o(e.value):new r(function(t){t(e.value);}).then(s,a);}c((n = n.apply(e,t || [])).next());});},a=this && this.__generator || function(e,t){var r,n,o,i,s={label:0,sent:function sent(){if(1 & o[0])throw o[1];return o[1];},trys:[],ops:[]};return i = {next:a(0),"throw":a(1),"return":a(2)},"function" == typeof Symbol && (i[Symbol.iterator] = function(){return this;}),i;function a(i){return function(a){return (function(i){if(r)throw new TypeError("Generator is already executing.");for(;s;) try{if((r = 1,n && (o = 2 & i[0]?n["return"]:i[0]?n["throw"] || ((o = n["return"]) && o.call(n),0):n.next) && !(o = o.call(n,i[1])).done))return o;switch((n = 0,o && (i = [2 & i[0],o.value]),i[0])){case 0:case 1:o = i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,n = i[1],i = [0];continue;case 7:i = s.ops.pop(),s.trys.pop();continue;default:if(!(o = s.trys,(o = o.length > 0 && o[o.length - 1]) || 6 !== i[0] && 2 !== i[0])){s = 0;continue;}if(3 === i[0] && (!o || i[1] > o[0] && i[1] < o[3])){s.label = i[1];break;}if(6 === i[0] && s.label < o[1]){s.label = o[1],o = i;break;}if(o && s.label < o[2]){s.label = o[2],s.ops.push(i);break;}o[2] && s.ops.pop(),s.trys.pop();continue;}i = t.call(e,s);}catch(e) {i = [6,e],n = 0;}finally {r = o = 0;}if(5 & i[0])throw i[1];return {value:i[0]?i[1]:void 0,done:!0};})([i,a]);};}};Object.defineProperty(r,"__esModule",{value:!0});var c=e("./Errors"),u=e("./HttpClient"),l=e("./ILogger"),h=e("./Utils"),f=(function(t){function r(r){var n=t.call(this) || this;if((n.logger = r,"undefined" == typeof fetch)){var o="function" == typeof __webpack_require__?__non_webpack_require__:e;n.jar = new (o("tough-cookie").CookieJar)(),n.fetchType = o("node-fetch"),n.fetchType = o("fetch-cookie")(n.fetchType,n.jar),n.abortControllerType = o("abort-controller");}else n.fetchType = fetch.bind(self),n.abortControllerType = AbortController;return n;}return o(r,t),r.prototype.send = function(e){return s(this,void 0,void 0,function(){var t,r,n,o,s,h,f,p=this;return a(this,function(a){switch(a.label){case 0:if(e.abortSignal && e.abortSignal.aborted)throw new c.AbortError();if(!e.method)throw new Error("No method defined.");if(!e.url)throw new Error("No url defined.");t = new this.abortControllerType(),e.abortSignal && (e.abortSignal.onabort = function(){t.abort(),r = new c.AbortError();}),n = null,e.timeout && (o = e.timeout,n = setTimeout(function(){t.abort(),p.logger.log(l.LogLevel.Warning,"Timeout from HTTP request."),r = new c.TimeoutError();},o)),a.label = 1;case 1:return a.trys.push([1,3,4,5]),[4,this.fetchType(e.url,{body:e.content,cache:"no-cache",credentials:!0 === e.withCredentials?"include":"same-origin",headers:i({"Content-Type":"text/plain;charset=UTF-8","X-Requested-With":"XMLHttpRequest"},e.headers),method:e.method,mode:"cors",redirect:"manual",signal:t.signal})];case 2:return s = a.sent(),[3,5];case 3:if((h = a.sent(),r))throw r;throw (this.logger.log(l.LogLevel.Warning,"Error from HTTP request. " + h + "."),h);case 4:return n && clearTimeout(n),e.abortSignal && (e.abortSignal.onabort = null),[7];case 5:if(!s.ok)throw new c.HttpError(s.statusText,s.status);return [4,(function(e,t){var r;switch(t){case "arraybuffer":r = e.arrayBuffer();break;case "text":r = e.text();break;case "blob":case "document":case "json":throw new Error(t + " is not supported.");default:r = e.text();}return r;})(s,e.responseType)];case 6:return f = a.sent(),[2,new u.HttpResponse(s.status,s.statusText,f)];}});});},r.prototype.getCookieString = function(e){var t="";return h.Platform.isNode && this.jar && this.jar.getCookies(e,function(e,r){return t = r.join("; ");}),t;},r;})(u.HttpClient);r.FetchHttpClient = f;},{"./Errors":4,"./HttpClient":7,"./ILogger":12,"./Utils":20}],6:[function(e,t,r){(function(t){(function(){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=e("./TextMessageFormat"),o=e("./Utils"),i=(function(){function e(){}return e.prototype.writeHandshakeRequest = function(e){return n.TextMessageFormat.write(JSON.stringify(e));},e.prototype.parseHandshakeResponse = function(e){var r,i;if(o.isArrayBuffer(e) || void 0 !== t && e instanceof t){var s=new Uint8Array(e);if(-1 === (c = s.indexOf(n.TextMessageFormat.RecordSeparatorCode)))throw new Error("Message is incomplete.");var a=c + 1;r = String.fromCharCode.apply(null,s.slice(0,a)),i = s.byteLength > a?s.slice(a).buffer:null;}else {var c,u=e;if(-1 === (c = u.indexOf(n.TextMessageFormat.RecordSeparator)))throw new Error("Message is incomplete.");a = c + 1;r = u.substring(0,a),i = u.length > a?u.substring(a):null;}var l=n.TextMessageFormat.parse(r),h=JSON.parse(l[0]);if(h.type)throw new Error("Expected a handshake response from the server.");return [i,h];},e;})();r.HandshakeProtocol = i;}).call(this);}).call(this,e("buffer").Buffer);},{"./TextMessageFormat":19,"./Utils":20,buffer:35}],7:[function(e,t,r){"use strict";var n=this && this.__assign || Object.assign || function(e){for(var t,r=1,n=arguments.length;r < n;r++) for(var o in t = arguments[r]) Object.prototype.hasOwnProperty.call(t,o) && (e[o] = t[o]);return e;};Object.defineProperty(r,"__esModule",{value:!0});var o=function o(e,t,r){this.statusCode = e,this.statusText = t,this.content = r;};r.HttpResponse = o;var i=(function(){function e(){}return e.prototype.get = function(e,t){return this.send(n({},t,{method:"GET",url:e}));},e.prototype.post = function(e,t){return this.send(n({},t,{method:"POST",url:e}));},e.prototype["delete"] = function(e,t){return this.send(n({},t,{method:"DELETE",url:e}));},e.prototype.getCookieString = function(e){return "";},e;})();r.HttpClient = i;},{}],8:[function(e,t,r){"use strict";var n=this && this.__assign || Object.assign || function(e){for(var t,r=1,n=arguments.length;r < n;r++) for(var o in t = arguments[r]) Object.prototype.hasOwnProperty.call(t,o) && (e[o] = t[o]);return e;},o=this && this.__awaiter || function(e,t,r,n){return new (r || (r = Promise))(function(o,i){function s(e){try{c(n.next(e));}catch(e) {i(e);}}function a(e){try{c(n["throw"](e));}catch(e) {i(e);}}function c(e){e.done?o(e.value):new r(function(t){t(e.value);}).then(s,a);}c((n = n.apply(e,t || [])).next());});},i=this && this.__generator || function(e,t){var r,n,o,i,s={label:0,sent:function sent(){if(1 & o[0])throw o[1];return o[1];},trys:[],ops:[]};return i = {next:a(0),"throw":a(1),"return":a(2)},"function" == typeof Symbol && (i[Symbol.iterator] = function(){return this;}),i;function a(i){return function(a){return (function(i){if(r)throw new TypeError("Generator is already executing.");for(;s;) try{if((r = 1,n && (o = 2 & i[0]?n["return"]:i[0]?n["throw"] || ((o = n["return"]) && o.call(n),0):n.next) && !(o = o.call(n,i[1])).done))return o;switch((n = 0,o && (i = [2 & i[0],o.value]),i[0])){case 0:case 1:o = i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,n = i[1],i = [0];continue;case 7:i = s.ops.pop(),s.trys.pop();continue;default:if(!(o = s.trys,(o = o.length > 0 && o[o.length - 1]) || 6 !== i[0] && 2 !== i[0])){s = 0;continue;}if(3 === i[0] && (!o || i[1] > o[0] && i[1] < o[3])){s.label = i[1];break;}if(6 === i[0] && s.label < o[1]){s.label = o[1],o = i;break;}if(o && s.label < o[2]){s.label = o[2],s.ops.push(i);break;}o[2] && s.ops.pop(),s.trys.pop();continue;}i = t.call(e,s);}catch(e) {i = [6,e],n = 0;}finally {r = o = 0;}if(5 & i[0])throw i[1];return {value:i[0]?i[1]:void 0,done:!0};})([i,a]);};}};Object.defineProperty(r,"__esModule",{value:!0});var s=e("./DefaultHttpClient"),a=e("./ILogger"),c=e("./ITransport"),u=e("./LongPollingTransport"),l=e("./ServerSentEventsTransport"),h=e("./Utils"),f=e("./WebSocketTransport"),p=(function(){function t(t,r){if((void 0 === r && (r = {}),this.features = {},this.negotiateVersion = 1,h.Arg.isRequired(t,"url"),this.logger = h.createLogger(r.logger),this.baseUrl = this.resolveUrl(t),(r = r || {}).logMessageContent = void 0 !== r.logMessageContent && r.logMessageContent,"boolean" != typeof r.withCredentials && void 0 !== r.withCredentials))throw new Error("withCredentials option was not a 'boolean' or 'undefined' value");r.withCredentials = void 0 === r.withCredentials || r.withCredentials;var n=null,o=null;if(h.Platform.isNode && void 0 !== e){var i="function" == typeof __webpack_require__?__non_webpack_require__:e;n = i("ws"),o = i("eventsource");}h.Platform.isNode || "undefined" == typeof WebSocket || r.WebSocket?h.Platform.isNode && !r.WebSocket && n && (r.WebSocket = n):r.WebSocket = WebSocket,h.Platform.isNode || "undefined" == typeof EventSource || r.EventSource?h.Platform.isNode && !r.EventSource && void 0 !== o && (r.EventSource = o):r.EventSource = EventSource,this.httpClient = r.httpClient || new s.DefaultHttpClient(this.logger),this.connectionState = "Disconnected",this.connectionStarted = !1,this.options = r,this.onreceive = null,this.onclose = null;}return t.prototype.start = function(e){return o(this,void 0,void 0,function(){var t;return i(this,function(r){switch(r.label){case 0:return e = e || c.TransferFormat.Binary,h.Arg.isIn(e,c.TransferFormat,"transferFormat"),this.logger.log(a.LogLevel.Debug,"Starting connection with transfer format '" + c.TransferFormat[e] + "'."),"Disconnected" !== this.connectionState?[2,Promise.reject(new Error("Cannot start an HttpConnection that is not in the 'Disconnected' state."))]:(this.connectionState = "Connecting",this.startInternalPromise = this.startInternal(e),[4,this.startInternalPromise]);case 1:return r.sent(),"Disconnecting" !== this.connectionState?[3,3]:(t = "Failed to start the HttpConnection before stop() was called.",this.logger.log(a.LogLevel.Error,t),[4,this.stopPromise]);case 2:return r.sent(),[2,Promise.reject(new Error(t))];case 3:if("Connected" !== this.connectionState)return t = "HttpConnection.startInternal completed gracefully but didn't enter the connection into the connected state!",this.logger.log(a.LogLevel.Error,t),[2,Promise.reject(new Error(t))];r.label = 4;case 4:return this.connectionStarted = !0,[2];}});});},t.prototype.send = function(e){return "Connected" !== this.connectionState?Promise.reject(new Error("Cannot send data if the connection is not in the 'Connected' State.")):(this.sendQueue || (this.sendQueue = new g(this.transport)),this.sendQueue.send(e));},t.prototype.stop = function(e){return o(this,void 0,void 0,function(){var t=this;return i(this,function(r){switch(r.label){case 0:return "Disconnected" === this.connectionState?(this.logger.log(a.LogLevel.Debug,"Call to HttpConnection.stop(" + e + ") ignored because the connection is already in the disconnected state."),[2,Promise.resolve()]):"Disconnecting" === this.connectionState?(this.logger.log(a.LogLevel.Debug,"Call to HttpConnection.stop(" + e + ") ignored because the connection is already in the disconnecting state."),[2,this.stopPromise]):(this.connectionState = "Disconnecting",this.stopPromise = new Promise(function(e){t.stopPromiseResolver = e;}),[4,this.stopInternal(e)]);case 1:return r.sent(),[4,this.stopPromise];case 2:return r.sent(),[2];}});});},t.prototype.stopInternal = function(e){return o(this,void 0,void 0,function(){var t;return i(this,function(r){switch(r.label){case 0:this.stopError = e,r.label = 1;case 1:return r.trys.push([1,3,,4]),[4,this.startInternalPromise];case 2:return r.sent(),[3,4];case 3:return r.sent(),[3,4];case 4:if(!this.transport)return [3,9];r.label = 5;case 5:return r.trys.push([5,7,,8]),[4,this.transport.stop()];case 6:return r.sent(),[3,8];case 7:return t = r.sent(),this.logger.log(a.LogLevel.Error,"HttpConnection.transport.stop() threw error '" + t + "'."),this.stopConnection(),[3,8];case 8:return this.transport = void 0,[3,10];case 9:this.logger.log(a.LogLevel.Debug,"HttpConnection.transport is undefined in HttpConnection.stop() because start() failed."),this.stopConnection(),r.label = 10;case 10:return [2];}});});},t.prototype.startInternal = function(e){return o(this,void 0,void 0,function(){var t,r,n,o,s,l;return i(this,function(h){switch(h.label){case 0:t = this.baseUrl,this.accessTokenFactory = this.options.accessTokenFactory,h.label = 1;case 1:return h.trys.push([1,12,,13]),this.options.skipNegotiation?this.options.transport !== c.HttpTransportType.WebSockets?[3,3]:(this.transport = this.constructTransport(c.HttpTransportType.WebSockets),[4,this.startTransport(t,e)]):[3,5];case 2:return h.sent(),[3,4];case 3:throw new Error("Negotiation can only be skipped when using the WebSocket transport directly.");case 4:return [3,11];case 5:r = null,n = 0,o = function(){var e;return i(this,function(o){switch(o.label){case 0:return [4,s.getNegotiationResponse(t)];case 1:if((r = o.sent(),"Disconnecting" === s.connectionState || "Disconnected" === s.connectionState))throw new Error("The connection was stopped during negotiation.");if(r.error)throw new Error(r.error);if(r.ProtocolVersion)throw new Error("Detected a connection attempt to an ASP.NET SignalR Server. This client only supports connecting to an ASP.NET Core SignalR Server. See https://aka.ms/signalr-core-differences for details.");return r.url && (t = r.url),r.accessToken && (e = r.accessToken,s.accessTokenFactory = function(){return e;}),n++,[2];}});},s = this,h.label = 6;case 6:return [5,o()];case 7:h.sent(),h.label = 8;case 8:if(r.url && n < 100)return [3,6];h.label = 9;case 9:if(100 === n && r.url)throw new Error("Negotiate redirection limit exceeded.");return [4,this.createTransport(t,this.options.transport,r,e)];case 10:h.sent(),h.label = 11;case 11:return this.transport instanceof u.LongPollingTransport && (this.features.inherentKeepAlive = !0),"Connecting" === this.connectionState && (this.logger.log(a.LogLevel.Debug,"The HttpConnection connected successfully."),this.connectionState = "Connected"),[3,13];case 12:return l = h.sent(),this.logger.log(a.LogLevel.Error,"Failed to start the connection: " + l),this.connectionState = "Disconnected",this.transport = void 0,[2,Promise.reject(l)];case 13:return [2];}});});},t.prototype.getNegotiationResponse = function(e){return o(this,void 0,void 0,function(){var t,r,o,s,c,u,l,f,p;return i(this,function(i){switch(i.label){case 0:return t = {},this.accessTokenFactory?[4,this.accessTokenFactory()]:[3,2];case 1:(r = i.sent()) && (t.Authorization = "Bearer " + r),i.label = 2;case 2:o = h.getUserAgentHeader(),s = o[0],c = o[1],t[s] = c,u = this.resolveNegotiateUrl(e),this.logger.log(a.LogLevel.Debug,"Sending negotiation request: " + u + "."),i.label = 3;case 3:return i.trys.push([3,5,,6]),[4,this.httpClient.post(u,{content:"",headers:n({},t,this.options.headers),withCredentials:this.options.withCredentials})];case 4:return 200 !== (l = i.sent()).statusCode?[2,Promise.reject(new Error("Unexpected status code returned from negotiate '" + l.statusCode + "'"))]:((!(f = JSON.parse(l.content)).negotiateVersion || f.negotiateVersion < 1) && (f.connectionToken = f.connectionId),[2,f]);case 5:return p = i.sent(),this.logger.log(a.LogLevel.Error,"Failed to complete negotiation with the server: " + p),[2,Promise.reject(p)];case 6:return [2];}});});},t.prototype.createConnectUrl = function(e,t){return t?e + (-1 === e.indexOf("?")?"?":"&") + "id=" + t:e;},t.prototype.createTransport = function(e,t,r,n){return o(this,void 0,void 0,function(){var o,s,c,u,l,h,f,p,g,d,b;return i(this,function(i){switch(i.label){case 0:return o = this.createConnectUrl(e,r.connectionToken),this.isITransport(t)?(this.logger.log(a.LogLevel.Debug,"Connection was provided an instance of ITransport, using that directly."),this.transport = t,[4,this.startTransport(o,n)]):[3,2];case 1:return i.sent(),this.connectionId = r.connectionId,[2];case 2:s = [],c = r.availableTransports || [],u = r,l = 0,h = c,i.label = 3;case 3:return l < h.length?(f = h[l],(p = this.resolveTransportOrError(f,t,n)) instanceof Error?(s.push(f.transport + " failed: " + p),[3,12]):[3,4]):[3,13];case 4:if(!this.isITransport(p))return [3,12];if((this.transport = p,u))return [3,9];i.label = 5;case 5:return i.trys.push([5,7,,8]),[4,this.getNegotiationResponse(e)];case 6:return u = i.sent(),[3,8];case 7:return g = i.sent(),[2,Promise.reject(g)];case 8:o = this.createConnectUrl(e,u.connectionToken),i.label = 9;case 9:return i.trys.push([9,11,,12]),[4,this.startTransport(o,n)];case 10:return i.sent(),this.connectionId = u.connectionId,[2];case 11:return d = i.sent(),this.logger.log(a.LogLevel.Error,"Failed to start the transport '" + f.transport + "': " + d),u = void 0,s.push(f.transport + " failed: " + d),"Connecting" !== this.connectionState?(b = "Failed to select transport before stop() was called.",this.logger.log(a.LogLevel.Debug,b),[2,Promise.reject(new Error(b))]):[3,12];case 12:return l++,[3,3];case 13:return s.length > 0?[2,Promise.reject(new Error("Unable to connect to the server with any of the available transports. " + s.join(" ")))]:[2,Promise.reject(new Error("None of the transports supported by the client are supported by the server."))];}});});},t.prototype.constructTransport = function(e){switch(e){case c.HttpTransportType.WebSockets:if(!this.options.WebSocket)throw new Error("'WebSocket' is not supported in your environment.");return new f.WebSocketTransport(this.httpClient,this.accessTokenFactory,this.logger,this.options.logMessageContent || !1,this.options.WebSocket,this.options.headers || {});case c.HttpTransportType.ServerSentEvents:if(!this.options.EventSource)throw new Error("'EventSource' is not supported in your environment.");return new l.ServerSentEventsTransport(this.httpClient,this.accessTokenFactory,this.logger,this.options.logMessageContent || !1,this.options.EventSource,this.options.withCredentials,this.options.headers || {});case c.HttpTransportType.LongPolling:return new u.LongPollingTransport(this.httpClient,this.accessTokenFactory,this.logger,this.options.logMessageContent || !1,this.options.withCredentials,this.options.headers || {});default:throw new Error("Unknown transport: " + e + ".");}},t.prototype.startTransport = function(e,t){var r=this;return this.transport.onreceive = this.onreceive,this.transport.onclose = function(e){return r.stopConnection(e);},this.transport.connect(e,t);},t.prototype.resolveTransportOrError = function(e,t,r){var n=c.HttpTransportType[e.transport];if(null == n)return this.logger.log(a.LogLevel.Debug,"Skipping transport '" + e.transport + "' because it is not supported by this client."),new Error("Skipping transport '" + e.transport + "' because it is not supported by this client.");if(!(function(e,t){return !e || 0 != (t & e);})(t,n))return this.logger.log(a.LogLevel.Debug,"Skipping transport '" + c.HttpTransportType[n] + "' because it was disabled by the client."),new Error("'" + c.HttpTransportType[n] + "' is disabled by the client.");if(!(e.transferFormats.map(function(e){return c.TransferFormat[e];}).indexOf(r) >= 0))return this.logger.log(a.LogLevel.Debug,"Skipping transport '" + c.HttpTransportType[n] + "' because it does not support the requested transfer format '" + c.TransferFormat[r] + "'."),new Error("'" + c.HttpTransportType[n] + "' does not support " + c.TransferFormat[r] + ".");if(n === c.HttpTransportType.WebSockets && !this.options.WebSocket || n === c.HttpTransportType.ServerSentEvents && !this.options.EventSource)return this.logger.log(a.LogLevel.Debug,"Skipping transport '" + c.HttpTransportType[n] + "' because it is not supported in your environment.'"),new Error("'" + c.HttpTransportType[n] + "' is not supported in your environment.");this.logger.log(a.LogLevel.Debug,"Selecting transport '" + c.HttpTransportType[n] + "'.");try{return this.constructTransport(n);}catch(e) {return e;}},t.prototype.isITransport = function(e){return e && "object" == typeof e && "connect" in e;},t.prototype.stopConnection = function(e){var t=this;if((this.logger.log(a.LogLevel.Debug,"HttpConnection.stopConnection(" + e + ") called while in state " + this.connectionState + "."),this.transport = void 0,e = this.stopError || e,this.stopError = void 0,"Disconnected" !== this.connectionState)){if("Connecting" === this.connectionState)throw (this.logger.log(a.LogLevel.Warning,"Call to HttpConnection.stopConnection(" + e + ") was ignored because the connection is still in the connecting state."),new Error("HttpConnection.stopConnection(" + e + ") was called while the connection is still in the connecting state."));if(("Disconnecting" === this.connectionState && this.stopPromiseResolver(),e?this.logger.log(a.LogLevel.Error,"Connection disconnected with error '" + e + "'."):this.logger.log(a.LogLevel.Information,"Connection disconnected."),this.sendQueue && (this.sendQueue.stop()["catch"](function(e){t.logger.log(a.LogLevel.Error,"TransportSendQueue.stop() threw error '" + e + "'.");}),this.sendQueue = void 0),this.connectionId = void 0,this.connectionState = "Disconnected",this.connectionStarted)){this.connectionStarted = !1;try{this.onclose && this.onclose(e);}catch(t) {this.logger.log(a.LogLevel.Error,"HttpConnection.onclose(" + e + ") threw error '" + t + "'.");}}}else this.logger.log(a.LogLevel.Debug,"Call to HttpConnection.stopConnection(" + e + ") was ignored because the connection is already in the disconnected state.");},t.prototype.resolveUrl = function(e){if(0 === e.lastIndexOf("https://",0) || 0 === e.lastIndexOf("http://",0))return e;if(!h.Platform.isBrowser || !window.document)throw new Error("Cannot resolve '" + e + "'.");var t=window.document.createElement("a");return t.href = e,this.logger.log(a.LogLevel.Information,"Normalizing '" + e + "' to '" + t.href + "'."),t.href;},t.prototype.resolveNegotiateUrl = function(e){var t=e.indexOf("?"),r=e.substring(0,-1 === t?e.length:t);return "/" !== r[r.length - 1] && (r += "/"),r += "negotiate",-1 === (r += -1 === t?"":e.substring(t)).indexOf("negotiateVersion") && (r += -1 === t?"?":"&",r += "negotiateVersion=" + this.negotiateVersion),r;},t;})();r.HttpConnection = p;var g=(function(){function e(e){this.transport = e,this.buffer = [],this.executing = !0,this.sendBufferedData = new d(),this.transportResult = new d(),this.sendLoopPromise = this.sendLoop();}return e.prototype.send = function(e){return this.bufferData(e),this.transportResult || (this.transportResult = new d()),this.transportResult.promise;},e.prototype.stop = function(){return this.executing = !1,this.sendBufferedData.resolve(),this.sendLoopPromise;},e.prototype.bufferData = function(e){if(this.buffer.length && typeof this.buffer[0] != typeof e)throw new Error("Expected data to be of type " + typeof this.buffer + " but was of type " + typeof e);this.buffer.push(e),this.sendBufferedData.resolve();},e.prototype.sendLoop = function(){return o(this,void 0,void 0,function(){var t,r,n;return i(this,function(o){switch(o.label){case 0:return [4,this.sendBufferedData.promise];case 1:if((o.sent(),!this.executing))return this.transportResult && this.transportResult.reject("Connection stopped."),[3,6];this.sendBufferedData = new d(),t = this.transportResult,this.transportResult = void 0,r = "string" == typeof this.buffer[0]?this.buffer.join(""):e.concatBuffers(this.buffer),this.buffer.length = 0,o.label = 2;case 2:return o.trys.push([2,4,,5]),[4,this.transport.send(r)];case 3:return o.sent(),t.resolve(),[3,5];case 4:return n = o.sent(),t.reject(n),[3,5];case 5:return [3,0];case 6:return [2];}});});},e.concatBuffers = function(e){for(var t=e.map(function(e){return e.byteLength;}).reduce(function(e,t){return e + t;}),r=new Uint8Array(t),n=0,o=0,i=e;o < i.length;o++) {var s=i[o];r.set(new Uint8Array(s),n),n += s.byteLength;}return r.buffer;},e;})();r.TransportSendQueue = g;var d=(function(){function e(){var e=this;this.promise = new Promise(function(t,r){var n;return n = [t,r],e.resolver = n[0],e.rejecter = n[1],n;});}return e.prototype.resolve = function(){this.resolver();},e.prototype.reject = function(e){this.rejecter(e);},e;})();},{"./DefaultHttpClient":2,"./ILogger":12,"./ITransport":13,"./LongPollingTransport":16,"./ServerSentEventsTransport":17,"./Utils":20,"./WebSocketTransport":21}],9:[function(e,t,r){"use strict";var n=this && this.__awaiter || function(e,t,r,n){return new (r || (r = Promise))(function(o,i){function s(e){try{c(n.next(e));}catch(e) {i(e);}}function a(e){try{c(n["throw"](e));}catch(e) {i(e);}}function c(e){e.done?o(e.value):new r(function(t){t(e.value);}).then(s,a);}c((n = n.apply(e,t || [])).next());});},o=this && this.__generator || function(e,t){var r,n,o,i,s={label:0,sent:function sent(){if(1 & o[0])throw o[1];return o[1];},trys:[],ops:[]};return i = {next:a(0),"throw":a(1),"return":a(2)},"function" == typeof Symbol && (i[Symbol.iterator] = function(){return this;}),i;function a(i){return function(a){return (function(i){if(r)throw new TypeError("Generator is already executing.");for(;s;) try{if((r = 1,n && (o = 2 & i[0]?n["return"]:i[0]?n["throw"] || ((o = n["return"]) && o.call(n),0):n.next) && !(o = o.call(n,i[1])).done))return o;switch((n = 0,o && (i = [2 & i[0],o.value]),i[0])){case 0:case 1:o = i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,n = i[1],i = [0];continue;case 7:i = s.ops.pop(),s.trys.pop();continue;default:if(!(o = s.trys,(o = o.length > 0 && o[o.length - 1]) || 6 !== i[0] && 2 !== i[0])){s = 0;continue;}if(3 === i[0] && (!o || i[1] > o[0] && i[1] < o[3])){s.label = i[1];break;}if(6 === i[0] && s.label < o[1]){s.label = o[1],o = i;break;}if(o && s.label < o[2]){s.label = o[2],s.ops.push(i);break;}o[2] && s.ops.pop(),s.trys.pop();continue;}i = t.call(e,s);}catch(e) {i = [6,e],n = 0;}finally {r = o = 0;}if(5 & i[0])throw i[1];return {value:i[0]?i[1]:void 0,done:!0};})([i,a]);};}};Object.defineProperty(r,"__esModule",{value:!0});var i,s=e("./HandshakeProtocol"),a=e("./IHubProtocol"),c=e("./ILogger"),u=e("./Subject"),l=e("./Utils");!(function(e){e.Disconnected = "Disconnected",e.Connecting = "Connecting",e.Connected = "Connected",e.Disconnecting = "Disconnecting",e.Reconnecting = "Reconnecting";})(i = r.HubConnectionState || (r.HubConnectionState = {}));var h=(function(){function e(e,t,r,n){var o=this;l.Arg.isRequired(e,"connection"),l.Arg.isRequired(t,"logger"),l.Arg.isRequired(r,"protocol"),this.serverTimeoutInMilliseconds = 3e4,this.keepAliveIntervalInMilliseconds = 15e3,this.logger = t,this.protocol = r,this.connection = e,this.reconnectPolicy = n,this.handshakeProtocol = new s.HandshakeProtocol(),this.connection.onreceive = function(e){return o.processIncomingData(e);},this.connection.onclose = function(e){return o.connectionClosed(e);},this.callbacks = {},this.methods = {},this.closedCallbacks = [],this.reconnectingCallbacks = [],this.reconnectedCallbacks = [],this.invocationId = 0,this.receivedHandshakeResponse = !1,this.connectionState = i.Disconnected,this.connectionStarted = !1,this.cachedPingMessage = this.protocol.writeMessage({type:a.MessageType.Ping});}return e.create = function(t,r,n,o){return new e(t,r,n,o);},Object.defineProperty(e.prototype,"state",{get:function get(){return this.connectionState;},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"connectionId",{get:function get(){return this.connection && this.connection.connectionId || null;},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"baseUrl",{get:function get(){return this.connection.baseUrl || "";},set:function set(e){if(this.connectionState !== i.Disconnected && this.connectionState !== i.Reconnecting)throw new Error("The HubConnection must be in the Disconnected or Reconnecting state to change the url.");if(!e)throw new Error("The HubConnection url must be a valid url.");this.connection.baseUrl = e;},enumerable:!0,configurable:!0}),e.prototype.start = function(){return this.startPromise = this.startWithStateTransitions(),this.startPromise;},e.prototype.startWithStateTransitions = function(){return n(this,void 0,void 0,function(){var e;return o(this,function(t){switch(t.label){case 0:if(this.connectionState !== i.Disconnected)return [2,Promise.reject(new Error("Cannot start a HubConnection that is not in the 'Disconnected' state."))];this.connectionState = i.Connecting,this.logger.log(c.LogLevel.Debug,"Starting HubConnection."),t.label = 1;case 1:return t.trys.push([1,3,,4]),[4,this.startInternal()];case 2:return t.sent(),this.connectionState = i.Connected,this.connectionStarted = !0,this.logger.log(c.LogLevel.Debug,"HubConnection connected successfully."),[3,4];case 3:return e = t.sent(),this.connectionState = i.Disconnected,this.logger.log(c.LogLevel.Debug,"HubConnection failed to start successfully because of error '" + e + "'."),[2,Promise.reject(e)];case 4:return [2];}});});},e.prototype.startInternal = function(){return n(this,void 0,void 0,function(){var e,t,r,n=this;return o(this,function(o){switch(o.label){case 0:return this.stopDuringStartError = void 0,this.receivedHandshakeResponse = !1,e = new Promise(function(e,t){n.handshakeResolver = e,n.handshakeRejecter = t;}),[4,this.connection.start(this.protocol.transferFormat)];case 1:o.sent(),o.label = 2;case 2:return o.trys.push([2,5,,7]),t = {protocol:this.protocol.name,version:this.protocol.version},this.logger.log(c.LogLevel.Debug,"Sending handshake request."),[4,this.sendMessage(this.handshakeProtocol.writeHandshakeRequest(t))];case 3:return o.sent(),this.logger.log(c.LogLevel.Information,"Using HubProtocol '" + this.protocol.name + "'."),this.cleanupTimeout(),this.resetTimeoutPeriod(),this.resetKeepAliveInterval(),[4,e];case 4:if((o.sent(),this.stopDuringStartError))throw this.stopDuringStartError;return [3,7];case 5:return r = o.sent(),this.logger.log(c.LogLevel.Debug,"Hub handshake failed with error '" + r + "' during start(). Stopping HubConnection."),this.cleanupTimeout(),this.cleanupPingTimer(),[4,this.connection.stop(r)];case 6:throw (o.sent(),r);case 7:return [2];}});});},e.prototype.stop = function(){return n(this,void 0,void 0,function(){var e;return o(this,function(t){switch(t.label){case 0:return e = this.startPromise,this.stopPromise = this.stopInternal(),[4,this.stopPromise];case 1:t.sent(),t.label = 2;case 2:return t.trys.push([2,4,,5]),[4,e];case 3:return t.sent(),[3,5];case 4:return t.sent(),[3,5];case 5:return [2];}});});},e.prototype.stopInternal = function(e){return this.connectionState === i.Disconnected?(this.logger.log(c.LogLevel.Debug,"Call to HubConnection.stop(" + e + ") ignored because it is already in the disconnected state."),Promise.resolve()):this.connectionState === i.Disconnecting?(this.logger.log(c.LogLevel.Debug,"Call to HttpConnection.stop(" + e + ") ignored because the connection is already in the disconnecting state."),this.stopPromise):(this.connectionState = i.Disconnecting,this.logger.log(c.LogLevel.Debug,"Stopping HubConnection."),this.reconnectDelayHandle?(this.logger.log(c.LogLevel.Debug,"Connection stopped during reconnect delay. Done reconnecting."),clearTimeout(this.reconnectDelayHandle),this.reconnectDelayHandle = void 0,this.completeClose(),Promise.resolve()):(this.cleanupTimeout(),this.cleanupPingTimer(),this.stopDuringStartError = e || new Error("The connection was stopped before the hub handshake could complete."),this.connection.stop(e)));},e.prototype.stream = function(e){for(var t=this,r=[],n=1;n < arguments.length;n++) r[n - 1] = arguments[n];var o,i=this.replaceStreamingParams(r),s=i[0],c=i[1],l=this.createStreamInvocation(e,r,c),h=new u.Subject();return h.cancelCallback = function(){var e=t.createCancelInvocation(l.invocationId);return delete t.callbacks[l.invocationId],o.then(function(){return t.sendWithProtocol(e);});},this.callbacks[l.invocationId] = function(e,t){t?h.error(t):e && (e.type === a.MessageType.Completion?e.error?h.error(new Error(e.error)):h.complete():h.next(e.item));},o = this.sendWithProtocol(l)["catch"](function(e){h.error(e),delete t.callbacks[l.invocationId];}),this.launchStreams(s,o),h;},e.prototype.sendMessage = function(e){return this.resetKeepAliveInterval(),this.connection.send(e);},e.prototype.sendWithProtocol = function(e){return this.sendMessage(this.protocol.writeMessage(e));},e.prototype.send = function(e){for(var t=[],r=1;r < arguments.length;r++) t[r - 1] = arguments[r];var n=this.replaceStreamingParams(t),o=n[0],i=n[1],s=this.sendWithProtocol(this.createInvocation(e,t,!0,i));return this.launchStreams(o,s),s;},e.prototype.invoke = function(e){for(var t=this,r=[],n=1;n < arguments.length;n++) r[n - 1] = arguments[n];var o=this.replaceStreamingParams(r),i=o[0],s=o[1],c=this.createInvocation(e,r,!1,s),u=new Promise(function(e,r){t.callbacks[c.invocationId] = function(t,n){n?r(n):t && (t.type === a.MessageType.Completion?t.error?r(new Error(t.error)):e(t.result):r(new Error("Unexpected message type: " + t.type)));};var n=t.sendWithProtocol(c)["catch"](function(e){r(e),delete t.callbacks[c.invocationId];});t.launchStreams(i,n);});return u;},e.prototype.on = function(e,t){e && t && (e = e.toLowerCase(),this.methods[e] || (this.methods[e] = []),-1 === this.methods[e].indexOf(t) && this.methods[e].push(t));},e.prototype.off = function(e,t){if(e){e = e.toLowerCase();var r=this.methods[e];if(r)if(t){var n=r.indexOf(t);-1 !== n && (r.splice(n,1),0 === r.length && delete this.methods[e]);}else delete this.methods[e];}},e.prototype.onclose = function(e){e && this.closedCallbacks.push(e);},e.prototype.onreconnecting = function(e){e && this.reconnectingCallbacks.push(e);},e.prototype.onreconnected = function(e){e && this.reconnectedCallbacks.push(e);},e.prototype.processIncomingData = function(e){if((this.cleanupTimeout(),this.receivedHandshakeResponse || (e = this.processHandshakeResponse(e),this.receivedHandshakeResponse = !0),e))for(var t=0,r=this.protocol.parseMessages(e,this.logger);t < r.length;t++) {var n=r[t];switch(n.type){case a.MessageType.Invocation:this.invokeClientMethod(n);break;case a.MessageType.StreamItem:case a.MessageType.Completion:var o=this.callbacks[n.invocationId];o && (n.type === a.MessageType.Completion && delete this.callbacks[n.invocationId],o(n));break;case a.MessageType.Ping:break;case a.MessageType.Close:this.logger.log(c.LogLevel.Information,"Close message received from server.");var i=n.error?new Error("Server returned an error on close: " + n.error):void 0;!0 === n.allowReconnect?this.connection.stop(i):this.stopPromise = this.stopInternal(i);break;default:this.logger.log(c.LogLevel.Warning,"Invalid message type: " + n.type + ".");}}this.resetTimeoutPeriod();},e.prototype.processHandshakeResponse = function(e){var t,r,n;try{n = (t = this.handshakeProtocol.parseHandshakeResponse(e))[0],r = t[1];}catch(e) {var o="Error parsing handshake response: " + e;this.logger.log(c.LogLevel.Error,o);var i=new Error(o);throw (this.handshakeRejecter(i),i);}if(r.error){o = "Server returned handshake error: " + r.error;this.logger.log(c.LogLevel.Error,o);i = new Error(o);throw (this.handshakeRejecter(i),i);}return this.logger.log(c.LogLevel.Debug,"Server handshake complete."),this.handshakeResolver(),n;},e.prototype.resetKeepAliveInterval = function(){var e=this;this.connection.features.inherentKeepAlive || (this.cleanupPingTimer(),this.pingServerHandle = setTimeout(function(){return n(e,void 0,void 0,function(){return o(this,function(e){switch(e.label){case 0:if(this.connectionState !== i.Connected)return [3,4];e.label = 1;case 1:return e.trys.push([1,3,,4]),[4,this.sendMessage(this.cachedPingMessage)];case 2:return e.sent(),[3,4];case 3:return e.sent(),this.cleanupPingTimer(),[3,4];case 4:return [2];}});});},this.keepAliveIntervalInMilliseconds));},e.prototype.resetTimeoutPeriod = function(){var e=this;this.connection.features && this.connection.features.inherentKeepAlive || (this.timeoutHandle = setTimeout(function(){return e.serverTimeout();},this.serverTimeoutInMilliseconds));},e.prototype.serverTimeout = function(){this.connection.stop(new Error("Server timeout elapsed without receiving a message from the server."));},e.prototype.invokeClientMethod = function(e){var t=this,r=this.methods[e.target.toLowerCase()];if(r){try{r.forEach(function(r){return r.apply(t,e.arguments);});}catch(t) {this.logger.log(c.LogLevel.Error,"A callback for the method " + e.target.toLowerCase() + " threw error '" + t + "'.");}if(e.invocationId){var n="Server requested a response, which is not supported in this version of the client.";this.logger.log(c.LogLevel.Error,n),this.stopPromise = this.stopInternal(new Error(n));}}else this.logger.log(c.LogLevel.Warning,"No client method with the name '" + e.target + "' found.");},e.prototype.connectionClosed = function(e){this.logger.log(c.LogLevel.Debug,"HubConnection.connectionClosed(" + e + ") called while in state " + this.connectionState + "."),this.stopDuringStartError = this.stopDuringStartError || e || new Error("The underlying connection was closed before the hub handshake could complete."),this.handshakeResolver && this.handshakeResolver(),this.cancelCallbacksWithError(e || new Error("Invocation canceled due to the underlying connection being closed.")),this.cleanupTimeout(),this.cleanupPingTimer(),this.connectionState === i.Disconnecting?this.completeClose(e):this.connectionState === i.Connected && this.reconnectPolicy?this.reconnect(e):this.connectionState === i.Connected && this.completeClose(e);},e.prototype.completeClose = function(e){var t=this;if(this.connectionStarted){this.connectionState = i.Disconnected,this.connectionStarted = !1;try{this.closedCallbacks.forEach(function(r){return r.apply(t,[e]);});}catch(t) {this.logger.log(c.LogLevel.Error,"An onclose callback called with error '" + e + "' threw error '" + t + "'.");}}},e.prototype.reconnect = function(e){return n(this,void 0,void 0,function(){var t,r,n,s,a,u=this;return o(this,function(o){switch(o.label){case 0:if((t = Date.now(),r = 0,n = void 0 !== e?e:new Error("Attempting to reconnect due to a unknown error."),null === (s = this.getNextRetryDelay(r++,0,n))))return this.logger.log(c.LogLevel.Debug,"Connection not reconnecting because the IRetryPolicy returned null on the first reconnect attempt."),this.completeClose(e),[2];if((this.connectionState = i.Reconnecting,e?this.logger.log(c.LogLevel.Information,"Connection reconnecting because of error '" + e + "'."):this.logger.log(c.LogLevel.Information,"Connection reconnecting."),this.onreconnecting)){try{this.reconnectingCallbacks.forEach(function(t){return t.apply(u,[e]);});}catch(t) {this.logger.log(c.LogLevel.Error,"An onreconnecting callback called with error '" + e + "' threw error '" + t + "'.");}if(this.connectionState !== i.Reconnecting)return this.logger.log(c.LogLevel.Debug,"Connection left the reconnecting state in onreconnecting callback. Done reconnecting."),[2];}o.label = 1;case 1:return null === s?[3,7]:(this.logger.log(c.LogLevel.Information,"Reconnect attempt number " + r + " will start in " + s + " ms."),[4,new Promise(function(e){u.reconnectDelayHandle = setTimeout(e,s);})]);case 2:if((o.sent(),this.reconnectDelayHandle = void 0,this.connectionState !== i.Reconnecting))return this.logger.log(c.LogLevel.Debug,"Connection left the reconnecting state during reconnect delay. Done reconnecting."),[2];o.label = 3;case 3:return o.trys.push([3,5,,6]),[4,this.startInternal()];case 4:if((o.sent(),this.connectionState = i.Connected,this.logger.log(c.LogLevel.Information,"HubConnection reconnected successfully."),this.onreconnected))try{this.reconnectedCallbacks.forEach(function(e){return e.apply(u,[u.connection.connectionId]);});}catch(e) {this.logger.log(c.LogLevel.Error,"An onreconnected callback called with connectionId '" + this.connection.connectionId + "; threw error '" + e + "'.");}return [2];case 5:return a = o.sent(),this.logger.log(c.LogLevel.Information,"Reconnect attempt failed because of error '" + a + "'."),this.connectionState !== i.Reconnecting?(this.logger.log(c.LogLevel.Debug,"Connection left the reconnecting state during reconnect attempt. Done reconnecting."),[2]):(n = a instanceof Error?a:new Error(a.toString()),s = this.getNextRetryDelay(r++,Date.now() - t,n),[3,6]);case 6:return [3,1];case 7:return this.logger.log(c.LogLevel.Information,"Reconnect retries have been exhausted after " + (Date.now() - t) + " ms and " + r + " failed attempts. Connection disconnecting."),this.completeClose(),[2];}});});},e.prototype.getNextRetryDelay = function(e,t,r){try{return this.reconnectPolicy.nextRetryDelayInMilliseconds({elapsedMilliseconds:t,previousRetryCount:e,retryReason:r});}catch(r) {return this.logger.log(c.LogLevel.Error,"IRetryPolicy.nextRetryDelayInMilliseconds(" + e + ", " + t + ") threw error '" + r + "'."),null;}},e.prototype.cancelCallbacksWithError = function(e){var t=this.callbacks;this.callbacks = {},Object.keys(t).forEach(function(r){(0,t[r])(null,e);});},e.prototype.cleanupPingTimer = function(){this.pingServerHandle && clearTimeout(this.pingServerHandle);},e.prototype.cleanupTimeout = function(){this.timeoutHandle && clearTimeout(this.timeoutHandle);},e.prototype.createInvocation = function(e,t,r,n){if(r)return 0 !== n.length?{arguments:t,streamIds:n,target:e,type:a.MessageType.Invocation}:{arguments:t,target:e,type:a.MessageType.Invocation};var o=this.invocationId;return this.invocationId++,0 !== n.length?{arguments:t,invocationId:o.toString(),streamIds:n,target:e,type:a.MessageType.Invocation}:{arguments:t,invocationId:o.toString(),target:e,type:a.MessageType.Invocation};},e.prototype.launchStreams = function(e,t){var r=this;if(0 !== e.length){t || (t = Promise.resolve());var n=function n(_n){e[_n].subscribe({complete:function complete(){t = t.then(function(){return r.sendWithProtocol(r.createCompletionMessage(_n));});},error:function error(e){var o;o = e instanceof Error?e.message:e && e.toString?e.toString():"Unknown error",t = t.then(function(){return r.sendWithProtocol(r.createCompletionMessage(_n,o));});},next:function next(e){t = t.then(function(){return r.sendWithProtocol(r.createStreamItemMessage(_n,e));});}});};for(var o in e) n(o);}},e.prototype.replaceStreamingParams = function(e){for(var t=[],r=[],n=0;n < e.length;n++) {var o=e[n];if(this.isObservable(o)){var i=this.invocationId;this.invocationId++,t[i] = o,r.push(i.toString()),e.splice(n,1);}}return [t,r];},e.prototype.isObservable = function(e){return e && e.subscribe && "function" == typeof e.subscribe;},e.prototype.createStreamInvocation = function(e,t,r){var n=this.invocationId;return this.invocationId++,0 !== r.length?{arguments:t,invocationId:n.toString(),streamIds:r,target:e,type:a.MessageType.StreamInvocation}:{arguments:t,invocationId:n.toString(),target:e,type:a.MessageType.StreamInvocation};},e.prototype.createCancelInvocation = function(e){return {invocationId:e,type:a.MessageType.CancelInvocation};},e.prototype.createStreamItemMessage = function(e,t){return {invocationId:e,item:t,type:a.MessageType.StreamItem};},e.prototype.createCompletionMessage = function(e,t,r){return t?{error:t,invocationId:e,type:a.MessageType.Completion}:{invocationId:e,result:r,type:a.MessageType.Completion};},e;})();r.HubConnection = h;},{"./HandshakeProtocol":6,"./IHubProtocol":11,"./ILogger":12,"./Subject":18,"./Utils":20}],10:[function(e,t,r){"use strict";var n=this && this.__assign || Object.assign || function(e){for(var t,r=1,n=arguments.length;r < n;r++) for(var o in t = arguments[r]) Object.prototype.hasOwnProperty.call(t,o) && (e[o] = t[o]);return e;};Object.defineProperty(r,"__esModule",{value:!0});var o=e("./DefaultReconnectPolicy"),i=e("./HttpConnection"),s=e("./HubConnection"),a=e("./ILogger"),c=e("./JsonHubProtocol"),u=e("./Loggers"),l=e("./Utils"),h={trace:a.LogLevel.Trace,debug:a.LogLevel.Debug,info:a.LogLevel.Information,information:a.LogLevel.Information,warn:a.LogLevel.Warning,warning:a.LogLevel.Warning,error:a.LogLevel.Error,critical:a.LogLevel.Critical,none:a.LogLevel.None};var f=(function(){function e(){}return e.prototype.configureLogging = function(e){if((l.Arg.isRequired(e,"logging"),void 0 !== e.log))this.logger = e;else if("string" == typeof e){var t=(function(e){var t=h[e.toLowerCase()];if(void 0 !== t)return t;throw new Error("Unknown log level: " + e);})(e);this.logger = new l.ConsoleLogger(t);}else this.logger = new l.ConsoleLogger(e);return this;},e.prototype.withUrl = function(e,t){return l.Arg.isRequired(e,"url"),l.Arg.isNotEmpty(e,"url"),this.url = e,this.httpConnectionOptions = n({},this.httpConnectionOptions,"object" == typeof t?t:{transport:t}),this;},e.prototype.withHubProtocol = function(e){return l.Arg.isRequired(e,"protocol"),this.protocol = e,this;},e.prototype.withAutomaticReconnect = function(e){if(this.reconnectPolicy)throw new Error("A reconnectPolicy has already been set.");return e?Array.isArray(e)?this.reconnectPolicy = new o.DefaultReconnectPolicy(e):this.reconnectPolicy = e:this.reconnectPolicy = new o.DefaultReconnectPolicy(),this;},e.prototype.build = function(){var e=this.httpConnectionOptions || {};if((void 0 === e.logger && (e.logger = this.logger),!this.url))throw new Error("The 'HubConnectionBuilder.withUrl' method must be called before building the connection.");var t=new i.HttpConnection(this.url,e);return s.HubConnection.create(t,this.logger || u.NullLogger.instance,this.protocol || new c.JsonHubProtocol(),this.reconnectPolicy);},e;})();r.HubConnectionBuilder = f;},{"./DefaultReconnectPolicy":3,"./HttpConnection":8,"./HubConnection":9,"./ILogger":12,"./JsonHubProtocol":14,"./Loggers":15,"./Utils":20}],11:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),(function(e){e[e.Invocation = 1] = "Invocation",e[e.StreamItem = 2] = "StreamItem",e[e.Completion = 3] = "Completion",e[e.StreamInvocation = 4] = "StreamInvocation",e[e.CancelInvocation = 5] = "CancelInvocation",e[e.Ping = 6] = "Ping",e[e.Close = 7] = "Close";})(r.MessageType || (r.MessageType = {}));},{}],12:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),(function(e){e[e.Trace = 0] = "Trace",e[e.Debug = 1] = "Debug",e[e.Information = 2] = "Information",e[e.Warning = 3] = "Warning",e[e.Error = 4] = "Error",e[e.Critical = 5] = "Critical",e[e.None = 6] = "None";})(r.LogLevel || (r.LogLevel = {}));},{}],13:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),(function(e){e[e.None = 0] = "None",e[e.WebSockets = 1] = "WebSockets",e[e.ServerSentEvents = 2] = "ServerSentEvents",e[e.LongPolling = 4] = "LongPolling";})(r.HttpTransportType || (r.HttpTransportType = {})),(function(e){e[e.Text = 1] = "Text",e[e.Binary = 2] = "Binary";})(r.TransferFormat || (r.TransferFormat = {}));},{}],14:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=e("./IHubProtocol"),o=e("./ILogger"),i=e("./ITransport"),s=e("./Loggers"),a=e("./TextMessageFormat"),c=(function(){function e(){this.name = "json",this.version = 1,this.transferFormat = i.TransferFormat.Text;}return e.prototype.parseMessages = function(e,t){if("string" != typeof e)throw new Error("Invalid input for JSON hub protocol. Expected a string.");if(!e)return [];null === t && (t = s.NullLogger.instance);for(var r=[],i=0,c=a.TextMessageFormat.parse(e);i < c.length;i++) {var u=c[i],l=JSON.parse(u);if("number" != typeof l.type)throw new Error("Invalid payload.");switch(l.type){case n.MessageType.Invocation:this.isInvocationMessage(l);break;case n.MessageType.StreamItem:this.isStreamItemMessage(l);break;case n.MessageType.Completion:this.isCompletionMessage(l);break;case n.MessageType.Ping:case n.MessageType.Close:break;default:t.log(o.LogLevel.Information,"Unknown message type '" + l.type + "' ignored.");continue;}r.push(l);}return r;},e.prototype.writeMessage = function(e){return a.TextMessageFormat.write(JSON.stringify(e));},e.prototype.isInvocationMessage = function(e){this.assertNotEmptyString(e.target,"Invalid payload for Invocation message."),void 0 !== e.invocationId && this.assertNotEmptyString(e.invocationId,"Invalid payload for Invocation message.");},e.prototype.isStreamItemMessage = function(e){if((this.assertNotEmptyString(e.invocationId,"Invalid payload for StreamItem message."),void 0 === e.item))throw new Error("Invalid payload for StreamItem message.");},e.prototype.isCompletionMessage = function(e){if(e.result && e.error)throw new Error("Invalid payload for Completion message.");!e.result && e.error && this.assertNotEmptyString(e.error,"Invalid payload for Completion message."),this.assertNotEmptyString(e.invocationId,"Invalid payload for Completion message.");},e.prototype.assertNotEmptyString = function(e,t){if("string" != typeof e || "" === e)throw new Error(t);},e;})();r.JsonHubProtocol = c;},{"./IHubProtocol":11,"./ILogger":12,"./ITransport":13,"./Loggers":15,"./TextMessageFormat":19}],15:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=(function(){function e(){}return e.prototype.log = function(e,t){},e.instance = new e(),e;})();r.NullLogger = n;},{}],16:[function(e,t,r){"use strict";var n=this && this.__assign || Object.assign || function(e){for(var t,r=1,n=arguments.length;r < n;r++) for(var o in t = arguments[r]) Object.prototype.hasOwnProperty.call(t,o) && (e[o] = t[o]);return e;},o=this && this.__awaiter || function(e,t,r,n){return new (r || (r = Promise))(function(o,i){function s(e){try{c(n.next(e));}catch(e) {i(e);}}function a(e){try{c(n["throw"](e));}catch(e) {i(e);}}function c(e){e.done?o(e.value):new r(function(t){t(e.value);}).then(s,a);}c((n = n.apply(e,t || [])).next());});},i=this && this.__generator || function(e,t){var r,n,o,i,s={label:0,sent:function sent(){if(1 & o[0])throw o[1];return o[1];},trys:[],ops:[]};return i = {next:a(0),"throw":a(1),"return":a(2)},"function" == typeof Symbol && (i[Symbol.iterator] = function(){return this;}),i;function a(i){return function(a){return (function(i){if(r)throw new TypeError("Generator is already executing.");for(;s;) try{if((r = 1,n && (o = 2 & i[0]?n["return"]:i[0]?n["throw"] || ((o = n["return"]) && o.call(n),0):n.next) && !(o = o.call(n,i[1])).done))return o;switch((n = 0,o && (i = [2 & i[0],o.value]),i[0])){case 0:case 1:o = i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,n = i[1],i = [0];continue;case 7:i = s.ops.pop(),s.trys.pop();continue;default:if(!(o = s.trys,(o = o.length > 0 && o[o.length - 1]) || 6 !== i[0] && 2 !== i[0])){s = 0;continue;}if(3 === i[0] && (!o || i[1] > o[0] && i[1] < o[3])){s.label = i[1];break;}if(6 === i[0] && s.label < o[1]){s.label = o[1],o = i;break;}if(o && s.label < o[2]){s.label = o[2],s.ops.push(i);break;}o[2] && s.ops.pop(),s.trys.pop();continue;}i = t.call(e,s);}catch(e) {i = [6,e],n = 0;}finally {r = o = 0;}if(5 & i[0])throw i[1];return {value:i[0]?i[1]:void 0,done:!0};})([i,a]);};}};Object.defineProperty(r,"__esModule",{value:!0});var s=e("./AbortController"),a=e("./Errors"),c=e("./ILogger"),u=e("./ITransport"),l=e("./Utils"),h=(function(){function e(e,t,r,n,o,i){this.httpClient = e,this.accessTokenFactory = t,this.logger = r,this.pollAbort = new s.AbortController(),this.logMessageContent = n,this.withCredentials = o,this.headers = i,this.running = !1,this.onreceive = null,this.onclose = null;}return Object.defineProperty(e.prototype,"pollAborted",{get:function get(){return this.pollAbort.aborted;},enumerable:!0,configurable:!0}),e.prototype.connect = function(e,t){return o(this,void 0,void 0,function(){var r,o,s,h,f,p,g,d,b;return i(this,function(i){switch(i.label){case 0:if((l.Arg.isRequired(e,"url"),l.Arg.isRequired(t,"transferFormat"),l.Arg.isIn(t,u.TransferFormat,"transferFormat"),this.url = e,this.logger.log(c.LogLevel.Trace,"(LongPolling transport) Connecting."),t === u.TransferFormat.Binary && "undefined" != typeof XMLHttpRequest && "string" != typeof new XMLHttpRequest().responseType))throw new Error("Binary protocols over XmlHttpRequest not implementing advanced features are not supported.");return o = l.getUserAgentHeader(),s = o[0],h = o[1],f = n(((r = {})[s] = h,r),this.headers),p = {abortSignal:this.pollAbort.signal,headers:f,timeout:1e5,withCredentials:this.withCredentials},t === u.TransferFormat.Binary && (p.responseType = "arraybuffer"),[4,this.getAccessToken()];case 1:return g = i.sent(),this.updateHeaderToken(p,g),d = e + "&_=" + Date.now(),this.logger.log(c.LogLevel.Trace,"(LongPolling transport) polling: " + d + "."),[4,this.httpClient.get(d,p)];case 2:return 200 !== (b = i.sent()).statusCode?(this.logger.log(c.LogLevel.Error,"(LongPolling transport) Unexpected response code: " + b.statusCode + "."),this.closeError = new a.HttpError(b.statusText || "",b.statusCode),this.running = !1):this.running = !0,this.receiving = this.poll(this.url,p),[2];}});});},e.prototype.getAccessToken = function(){return o(this,void 0,void 0,function(){return i(this,function(e){switch(e.label){case 0:return this.accessTokenFactory?[4,this.accessTokenFactory()]:[3,2];case 1:return [2,e.sent()];case 2:return [2,null];}});});},e.prototype.updateHeaderToken = function(e,t){e.headers || (e.headers = {}),t?e.headers.Authorization = "Bearer " + t:e.headers.Authorization && delete e.headers.Authorization;},e.prototype.poll = function(e,t){return o(this,void 0,void 0,function(){var r,n,o,s;return i(this,function(i){switch(i.label){case 0:i.trys.push([0,,8,9]),i.label = 1;case 1:return this.running?[4,this.getAccessToken()]:[3,7];case 2:r = i.sent(),this.updateHeaderToken(t,r),i.label = 3;case 3:return i.trys.push([3,5,,6]),n = e + "&_=" + Date.now(),this.logger.log(c.LogLevel.Trace,"(LongPolling transport) polling: " + n + "."),[4,this.httpClient.get(n,t)];case 4:return 204 === (o = i.sent()).statusCode?(this.logger.log(c.LogLevel.Information,"(LongPolling transport) Poll terminated by server."),this.running = !1):200 !== o.statusCode?(this.logger.log(c.LogLevel.Error,"(LongPolling transport) Unexpected response code: " + o.statusCode + "."),this.closeError = new a.HttpError(o.statusText || "",o.statusCode),this.running = !1):o.content?(this.logger.log(c.LogLevel.Trace,"(LongPolling transport) data received. " + l.getDataDetail(o.content,this.logMessageContent) + "."),this.onreceive && this.onreceive(o.content)):this.logger.log(c.LogLevel.Trace,"(LongPolling transport) Poll timed out, reissuing."),[3,6];case 5:return s = i.sent(),this.running?s instanceof a.TimeoutError?this.logger.log(c.LogLevel.Trace,"(LongPolling transport) Poll timed out, reissuing."):(this.closeError = s,this.running = !1):this.logger.log(c.LogLevel.Trace,"(LongPolling transport) Poll errored after shutdown: " + s.message),[3,6];case 6:return [3,1];case 7:return [3,9];case 8:return this.logger.log(c.LogLevel.Trace,"(LongPolling transport) Polling complete."),this.pollAborted || this.raiseOnClose(),[7];case 9:return [2];}});});},e.prototype.send = function(e){return o(this,void 0,void 0,function(){return i(this,function(t){return this.running?[2,l.sendMessage(this.logger,"LongPolling",this.httpClient,this.url,this.accessTokenFactory,e,this.logMessageContent,this.withCredentials,this.headers)]:[2,Promise.reject(new Error("Cannot send until the transport is connected"))];});});},e.prototype.stop = function(){return o(this,void 0,void 0,function(){var e,t,r,o,s,a;return i(this,function(i){switch(i.label){case 0:this.logger.log(c.LogLevel.Trace,"(LongPolling transport) Stopping polling."),this.running = !1,this.pollAbort.abort(),i.label = 1;case 1:return i.trys.push([1,,5,6]),[4,this.receiving];case 2:return i.sent(),this.logger.log(c.LogLevel.Trace,"(LongPolling transport) sending DELETE request to " + this.url + "."),e = {},t = l.getUserAgentHeader(),r = t[0],o = t[1],e[r] = o,s = {headers:n({},e,this.headers),withCredentials:this.withCredentials},[4,this.getAccessToken()];case 3:return a = i.sent(),this.updateHeaderToken(s,a),[4,this.httpClient["delete"](this.url,s)];case 4:return i.sent(),this.logger.log(c.LogLevel.Trace,"(LongPolling transport) DELETE request sent."),[3,6];case 5:return this.logger.log(c.LogLevel.Trace,"(LongPolling transport) Stop finished."),this.raiseOnClose(),[7];case 6:return [2];}});});},e.prototype.raiseOnClose = function(){if(this.onclose){var e="(LongPolling transport) Firing onclose event.";this.closeError && (e += " Error: " + this.closeError),this.logger.log(c.LogLevel.Trace,e),this.onclose(this.closeError);}},e;})();r.LongPollingTransport = h;},{"./AbortController":1,"./Errors":4,"./ILogger":12,"./ITransport":13,"./Utils":20}],17:[function(e,t,r){"use strict";var n=this && this.__assign || Object.assign || function(e){for(var t,r=1,n=arguments.length;r < n;r++) for(var o in t = arguments[r]) Object.prototype.hasOwnProperty.call(t,o) && (e[o] = t[o]);return e;},o=this && this.__awaiter || function(e,t,r,n){return new (r || (r = Promise))(function(o,i){function s(e){try{c(n.next(e));}catch(e) {i(e);}}function a(e){try{c(n["throw"](e));}catch(e) {i(e);}}function c(e){e.done?o(e.value):new r(function(t){t(e.value);}).then(s,a);}c((n = n.apply(e,t || [])).next());});},i=this && this.__generator || function(e,t){var r,n,o,i,s={label:0,sent:function sent(){if(1 & o[0])throw o[1];return o[1];},trys:[],ops:[]};return i = {next:a(0),"throw":a(1),"return":a(2)},"function" == typeof Symbol && (i[Symbol.iterator] = function(){return this;}),i;function a(i){return function(a){return (function(i){if(r)throw new TypeError("Generator is already executing.");for(;s;) try{if((r = 1,n && (o = 2 & i[0]?n["return"]:i[0]?n["throw"] || ((o = n["return"]) && o.call(n),0):n.next) && !(o = o.call(n,i[1])).done))return o;switch((n = 0,o && (i = [2 & i[0],o.value]),i[0])){case 0:case 1:o = i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,n = i[1],i = [0];continue;case 7:i = s.ops.pop(),s.trys.pop();continue;default:if(!(o = s.trys,(o = o.length > 0 && o[o.length - 1]) || 6 !== i[0] && 2 !== i[0])){s = 0;continue;}if(3 === i[0] && (!o || i[1] > o[0] && i[1] < o[3])){s.label = i[1];break;}if(6 === i[0] && s.label < o[1]){s.label = o[1],o = i;break;}if(o && s.label < o[2]){s.label = o[2],s.ops.push(i);break;}o[2] && s.ops.pop(),s.trys.pop();continue;}i = t.call(e,s);}catch(e) {i = [6,e],n = 0;}finally {r = o = 0;}if(5 & i[0])throw i[1];return {value:i[0]?i[1]:void 0,done:!0};})([i,a]);};}};Object.defineProperty(r,"__esModule",{value:!0});var s=e("./ILogger"),a=e("./ITransport"),c=e("./Utils"),u=(function(){function e(e,t,r,n,o,i,s){this.httpClient = e,this.accessTokenFactory = t,this.logger = r,this.logMessageContent = n,this.withCredentials = i,this.eventSourceConstructor = o,this.headers = s,this.onreceive = null,this.onclose = null;}return e.prototype.connect = function(e,t){return o(this,void 0,void 0,function(){var r,o=this;return i(this,function(i){switch(i.label){case 0:return c.Arg.isRequired(e,"url"),c.Arg.isRequired(t,"transferFormat"),c.Arg.isIn(t,a.TransferFormat,"transferFormat"),this.logger.log(s.LogLevel.Trace,"(SSE transport) Connecting."),this.url = e,this.accessTokenFactory?[4,this.accessTokenFactory()]:[3,2];case 1:(r = i.sent()) && (e += (e.indexOf("?") < 0?"?":"&") + "access_token=" + encodeURIComponent(r)),i.label = 2;case 2:return [2,new Promise(function(r,i){var u=!1;if(t === a.TransferFormat.Text){var l;if(c.Platform.isBrowser || c.Platform.isWebWorker)l = new o.eventSourceConstructor(e,{withCredentials:o.withCredentials});else {var h=o.httpClient.getCookieString(e),f={};f.Cookie = h;var p=c.getUserAgentHeader(),g=p[0],d=p[1];f[g] = d,l = new o.eventSourceConstructor(e,{withCredentials:o.withCredentials,headers:n({},f,o.headers)});}try{l.onmessage = function(e){if(o.onreceive)try{o.logger.log(s.LogLevel.Trace,"(SSE transport) data received. " + c.getDataDetail(e.data,o.logMessageContent) + "."),o.onreceive(e.data);}catch(e) {return void o.close(e);}},l.onerror = function(e){var t=new Error(e.data || "Error occurred");u?o.close(t):i(t);},l.onopen = function(){o.logger.log(s.LogLevel.Information,"SSE connected to " + o.url),o.eventSource = l,u = !0,r();};}catch(e) {return void i(e);}}else i(new Error("The Server-Sent Events transport only supports the 'Text' transfer format"));})];}});});},e.prototype.send = function(e){return o(this,void 0,void 0,function(){return i(this,function(t){return this.eventSource?[2,c.sendMessage(this.logger,"SSE",this.httpClient,this.url,this.accessTokenFactory,e,this.logMessageContent,this.withCredentials,this.headers)]:[2,Promise.reject(new Error("Cannot send until the transport is connected"))];});});},e.prototype.stop = function(){return this.close(),Promise.resolve();},e.prototype.close = function(e){this.eventSource && (this.eventSource.close(),this.eventSource = void 0,this.onclose && this.onclose(e));},e;})();r.ServerSentEventsTransport = u;},{"./ILogger":12,"./ITransport":13,"./Utils":20}],18:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=e("./Utils"),o=(function(){function e(){this.observers = [];}return e.prototype.next = function(e){for(var t=0,r=this.observers;t < r.length;t++) {r[t].next(e);}},e.prototype.error = function(e){for(var t=0,r=this.observers;t < r.length;t++) {var n=r[t];n.error && n.error(e);}},e.prototype.complete = function(){for(var e=0,t=this.observers;e < t.length;e++) {var r=t[e];r.complete && r.complete();}},e.prototype.subscribe = function(e){return this.observers.push(e),new n.SubjectSubscription(this,e);},e;})();r.Subject = o;},{"./Utils":20}],19:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=(function(){function e(){}return e.write = function(t){return "" + t + e.RecordSeparator;},e.parse = function(t){if(t[t.length - 1] !== e.RecordSeparator)throw new Error("Message is incomplete.");var r=t.split(e.RecordSeparator);return r.pop(),r;},e.RecordSeparatorCode = 30,e.RecordSeparator = String.fromCharCode(e.RecordSeparatorCode),e;})();r.TextMessageFormat = n;},{}],20:[function(e,t,r){(function(t){(function(){"use strict";var n=this && this.__assign || Object.assign || function(e){for(var t,r=1,n=arguments.length;r < n;r++) for(var o in t = arguments[r]) Object.prototype.hasOwnProperty.call(t,o) && (e[o] = t[o]);return e;},o=this && this.__awaiter || function(e,t,r,n){return new (r || (r = Promise))(function(o,i){function s(e){try{c(n.next(e));}catch(e) {i(e);}}function a(e){try{c(n["throw"](e));}catch(e) {i(e);}}function c(e){e.done?o(e.value):new r(function(t){t(e.value);}).then(s,a);}c((n = n.apply(e,t || [])).next());});},i=this && this.__generator || function(e,t){var r,n,o,i,s={label:0,sent:function sent(){if(1 & o[0])throw o[1];return o[1];},trys:[],ops:[]};return i = {next:a(0),"throw":a(1),"return":a(2)},"function" == typeof Symbol && (i[Symbol.iterator] = function(){return this;}),i;function a(i){return function(a){return (function(i){if(r)throw new TypeError("Generator is already executing.");for(;s;) try{if((r = 1,n && (o = 2 & i[0]?n["return"]:i[0]?n["throw"] || ((o = n["return"]) && o.call(n),0):n.next) && !(o = o.call(n,i[1])).done))return o;switch((n = 0,o && (i = [2 & i[0],o.value]),i[0])){case 0:case 1:o = i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,n = i[1],i = [0];continue;case 7:i = s.ops.pop(),s.trys.pop();continue;default:if(!(o = s.trys,(o = o.length > 0 && o[o.length - 1]) || 6 !== i[0] && 2 !== i[0])){s = 0;continue;}if(3 === i[0] && (!o || i[1] > o[0] && i[1] < o[3])){s.label = i[1];break;}if(6 === i[0] && s.label < o[1]){s.label = o[1],o = i;break;}if(o && s.label < o[2]){s.label = o[2],s.ops.push(i);break;}o[2] && s.ops.pop(),s.trys.pop();continue;}i = t.call(e,s);}catch(e) {i = [6,e],n = 0;}finally {r = o = 0;}if(5 & i[0])throw i[1];return {value:i[0]?i[1]:void 0,done:!0};})([i,a]);};}};Object.defineProperty(r,"__esModule",{value:!0});var s=e("./ILogger"),a=e("./Loggers");r.VERSION = "5.0.0";var c=(function(){function e(){}return e.isRequired = function(e,t){if(null == e)throw new Error("The '" + t + "' argument is required.");},e.isNotEmpty = function(e,t){if(!e || e.match(/^\s*$/))throw new Error("The '" + t + "' argument should not be empty.");},e.isIn = function(e,t,r){if(!(e in t))throw new Error("Unknown " + r + " value: " + e + ".");},e;})();r.Arg = c;var u=(function(){function e(){}return Object.defineProperty(e,"isBrowser",{get:function get(){return "object" == typeof window;},enumerable:!0,configurable:!0}),Object.defineProperty(e,"isWebWorker",{get:function get(){return "object" == typeof self && "importScripts" in self;},enumerable:!0,configurable:!0}),Object.defineProperty(e,"isNode",{get:function get(){return !this.isBrowser && !this.isWebWorker;},enumerable:!0,configurable:!0}),e;})();function l(e,t){var r="";return f(e)?(r = "Binary data of length " + e.byteLength,t && (r += ". Content: '" + h(e) + "'")):"string" == typeof e && (r = "String data of length " + e.length,t && (r += ". Content: '" + e + "'")),r;}function h(e){var t=new Uint8Array(e),r="";return t.forEach(function(e){r += "0x" + (e < 16?"0":"") + e.toString(16) + " ";}),r.substr(0,r.length - 1);}function f(e){return e && "undefined" != typeof ArrayBuffer && (e instanceof ArrayBuffer || e.constructor && "ArrayBuffer" === e.constructor.name);}r.Platform = u,r.getDataDetail = l,r.formatArrayBuffer = h,r.isArrayBuffer = f,r.sendMessage = function(e,t,r,a,c,u,h,p,g){return o(this,void 0,void 0,function(){var o,b,v,y,w,m,C,I;return i(this,function(i){switch(i.label){case 0:return b = {},c?[4,c()]:[3,2];case 1:(v = i.sent()) && ((o = {}).Authorization = "Bearer " + v,b = o),i.label = 2;case 2:return y = d(),w = y[0],m = y[1],b[w] = m,e.log(s.LogLevel.Trace,"(" + t + " transport) sending data. " + l(u,h) + "."),C = f(u)?"arraybuffer":"text",[4,r.post(a,{content:u,headers:n({},b,g),responseType:C,withCredentials:p})];case 3:return I = i.sent(),e.log(s.LogLevel.Trace,"(" + t + " transport) request complete. Response status: " + I.statusCode + "."),[2];}});});},r.createLogger = function(e){return void 0 === e?new g(s.LogLevel.Information):null === e?a.NullLogger.instance:e.log?e:new g(e);};var p=(function(){function e(e,t){this.subject = e,this.observer = t;}return e.prototype.dispose = function(){var e=this.subject.observers.indexOf(this.observer);e > -1 && this.subject.observers.splice(e,1),0 === this.subject.observers.length && this.subject.cancelCallback && this.subject.cancelCallback()["catch"](function(e){});},e;})();r.SubjectSubscription = p;var g=(function(){function e(e){this.minimumLogLevel = e,this.outputConsole = console;}return e.prototype.log = function(e,t){if(e >= this.minimumLogLevel)switch(e){case s.LogLevel.Critical:case s.LogLevel.Error:this.outputConsole.error("[" + new Date().toISOString() + "] " + s.LogLevel[e] + ": " + t);break;case s.LogLevel.Warning:this.outputConsole.warn("[" + new Date().toISOString() + "] " + s.LogLevel[e] + ": " + t);break;case s.LogLevel.Information:this.outputConsole.info("[" + new Date().toISOString() + "] " + s.LogLevel[e] + ": " + t);break;default:this.outputConsole.log("[" + new Date().toISOString() + "] " + s.LogLevel[e] + ": " + t);}},e;})();function d(){var e="X-SignalR-User-Agent";return u.isNode && (e = "User-Agent"),[e,b(r.VERSION,v(),w(),y())];}function b(e,t,r,n){var o="Microsoft SignalR/",i=e.split(".");return o += i[0] + "." + i[1],o += " (" + e + "; ",o += t && "" !== t?t + "; ":"Unknown OS; ",o += "" + r,o += n?"; " + n:"; Unknown Runtime Version",o += ")";}function v(){if(!u.isNode)return "";switch(t.platform){case "win32":return "Windows NT";case "darwin":return "macOS";case "linux":return "Linux";default:return t.platform;}}function y(){if(u.isNode)return t.versions.node;}function w(){return u.isNode?"NodeJS":"Browser";}r.ConsoleLogger = g,r.getUserAgentHeader = d,r.constructUserAgent = b;}).call(this);}).call(this,e("_process"));},{"./ILogger":12,"./Loggers":15,_process:37}],21:[function(e,t,r){"use strict";var n=this && this.__assign || Object.assign || function(e){for(var t,r=1,n=arguments.length;r < n;r++) for(var o in t = arguments[r]) Object.prototype.hasOwnProperty.call(t,o) && (e[o] = t[o]);return e;},o=this && this.__awaiter || function(e,t,r,n){return new (r || (r = Promise))(function(o,i){function s(e){try{c(n.next(e));}catch(e) {i(e);}}function a(e){try{c(n["throw"](e));}catch(e) {i(e);}}function c(e){e.done?o(e.value):new r(function(t){t(e.value);}).then(s,a);}c((n = n.apply(e,t || [])).next());});},i=this && this.__generator || function(e,t){var r,n,o,i,s={label:0,sent:function sent(){if(1 & o[0])throw o[1];return o[1];},trys:[],ops:[]};return i = {next:a(0),"throw":a(1),"return":a(2)},"function" == typeof Symbol && (i[Symbol.iterator] = function(){return this;}),i;function a(i){return function(a){return (function(i){if(r)throw new TypeError("Generator is already executing.");for(;s;) try{if((r = 1,n && (o = 2 & i[0]?n["return"]:i[0]?n["throw"] || ((o = n["return"]) && o.call(n),0):n.next) && !(o = o.call(n,i[1])).done))return o;switch((n = 0,o && (i = [2 & i[0],o.value]),i[0])){case 0:case 1:o = i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,n = i[1],i = [0];continue;case 7:i = s.ops.pop(),s.trys.pop();continue;default:if(!(o = s.trys,(o = o.length > 0 && o[o.length - 1]) || 6 !== i[0] && 2 !== i[0])){s = 0;continue;}if(3 === i[0] && (!o || i[1] > o[0] && i[1] < o[3])){s.label = i[1];break;}if(6 === i[0] && s.label < o[1]){s.label = o[1],o = i;break;}if(o && s.label < o[2]){s.label = o[2],s.ops.push(i);break;}o[2] && s.ops.pop(),s.trys.pop();continue;}i = t.call(e,s);}catch(e) {i = [6,e],n = 0;}finally {r = o = 0;}if(5 & i[0])throw i[1];return {value:i[0]?i[1]:void 0,done:!0};})([i,a]);};}};Object.defineProperty(r,"__esModule",{value:!0});var s=e("./ILogger"),a=e("./ITransport"),c=e("./Utils"),u=(function(){function e(e,t,r,n,o,i){this.logger = r,this.accessTokenFactory = t,this.logMessageContent = n,this.webSocketConstructor = o,this.httpClient = e,this.onreceive = null,this.onclose = null,this.headers = i;}return e.prototype.connect = function(e,t){return o(this,void 0,void 0,function(){var r,o=this;return i(this,function(i){switch(i.label){case 0:return c.Arg.isRequired(e,"url"),c.Arg.isRequired(t,"transferFormat"),c.Arg.isIn(t,a.TransferFormat,"transferFormat"),this.logger.log(s.LogLevel.Trace,"(WebSockets transport) Connecting."),this.accessTokenFactory?[4,this.accessTokenFactory()]:[3,2];case 1:(r = i.sent()) && (e += (e.indexOf("?") < 0?"?":"&") + "access_token=" + encodeURIComponent(r)),i.label = 2;case 2:return [2,new Promise(function(r,i){var u;e = e.replace(/^http/,"ws");var l=o.httpClient.getCookieString(e),h=!1;if(c.Platform.isNode){var f={},p=c.getUserAgentHeader(),g=p[0],d=p[1];f[g] = d,l && (f.Cookie = "" + l),u = new o.webSocketConstructor(e,void 0,{headers:n({},f,o.headers)});}u || (u = new o.webSocketConstructor(e)),t === a.TransferFormat.Binary && (u.binaryType = "arraybuffer"),u.onopen = function(t){o.logger.log(s.LogLevel.Information,"WebSocket connected to " + e + "."),o.webSocket = u,h = !0,r();},u.onerror = function(e){var t=null;t = "undefined" != typeof ErrorEvent && e instanceof ErrorEvent?e.error:new Error("There was an error with the transport."),i(t);},u.onmessage = function(e){if((o.logger.log(s.LogLevel.Trace,"(WebSockets transport) data received. " + c.getDataDetail(e.data,o.logMessageContent) + "."),o.onreceive))try{o.onreceive(e.data);}catch(e) {return void o.close(e);}},u.onclose = function(e){if(h)o.close(e);else {var t=null;t = "undefined" != typeof ErrorEvent && e instanceof ErrorEvent?e.error:new Error("There was an error with the transport."),i(t);}};})];}});});},e.prototype.send = function(e){return this.webSocket && this.webSocket.readyState === this.webSocketConstructor.OPEN?(this.logger.log(s.LogLevel.Trace,"(WebSockets transport) sending data. " + c.getDataDetail(e,this.logMessageContent) + "."),this.webSocket.send(e),Promise.resolve()):Promise.reject("WebSocket is not in the OPEN state");},e.prototype.stop = function(){return this.webSocket && this.close(void 0),Promise.resolve();},e.prototype.close = function(e){this.webSocket && (this.webSocket.onclose = function(){},this.webSocket.onmessage = function(){},this.webSocket.onerror = function(){},this.webSocket.close(),this.webSocket = void 0),this.logger.log(s.LogLevel.Trace,"(WebSockets transport) socket closed."),this.onclose && (!this.isCloseEvent(e) || !1 !== e.wasClean && 1e3 === e.code?e instanceof Error?this.onclose(e):this.onclose():this.onclose(new Error("WebSocket closed with status code: " + e.code + " (" + e.reason + ").")));},e.prototype.isCloseEvent = function(e){return e && "boolean" == typeof e.wasClean && "number" == typeof e.code;},e;})();r.WebSocketTransport = u;},{"./ILogger":12,"./ITransport":13,"./Utils":20}],22:[function(e,t,r){"use strict";var n,o=this && this.__extends || (n = Object.setPrototypeOf || {__proto__:[]} instanceof Array && function(e,t){e.__proto__ = t;} || function(e,t){for(var r in t) t.hasOwnProperty(r) && (e[r] = t[r]);},function(e,t){function r(){this.constructor = e;}n(e,t),e.prototype = null === t?Object.create(t):(r.prototype = t.prototype,new r());});Object.defineProperty(r,"__esModule",{value:!0});var i=e("./Errors"),s=e("./HttpClient"),a=e("./ILogger"),c=(function(e){function t(t){var r=e.call(this) || this;return r.logger = t,r;}return o(t,e),t.prototype.send = function(e){var t=this;return e.abortSignal && e.abortSignal.aborted?Promise.reject(new i.AbortError()):e.method?e.url?new Promise(function(r,n){var o=new XMLHttpRequest();o.open(e.method,e.url,!0),o.withCredentials = void 0 === e.withCredentials || e.withCredentials,o.setRequestHeader("X-Requested-With","XMLHttpRequest"),o.setRequestHeader("Content-Type","text/plain;charset=UTF-8");var c=e.headers;c && Object.keys(c).forEach(function(e){o.setRequestHeader(e,c[e]);}),e.responseType && (o.responseType = e.responseType),e.abortSignal && (e.abortSignal.onabort = function(){o.abort(),n(new i.AbortError());}),e.timeout && (o.timeout = e.timeout),o.onload = function(){e.abortSignal && (e.abortSignal.onabort = null),o.status >= 200 && o.status < 300?r(new s.HttpResponse(o.status,o.statusText,o.response || o.responseText)):n(new i.HttpError(o.statusText,o.status));},o.onerror = function(){t.logger.log(a.LogLevel.Warning,"Error from HTTP request. " + o.status + ": " + o.statusText + "."),n(new i.HttpError(o.statusText,o.status));},o.ontimeout = function(){t.logger.log(a.LogLevel.Warning,"Timeout from HTTP request."),n(new i.TimeoutError());},o.send(e.content || "");}):Promise.reject(new Error("No url defined.")):Promise.reject(new Error("No method defined."));},t;})(s.HttpClient);r.XhrHttpClient = c;},{"./Errors":4,"./HttpClient":7,"./ILogger":12}],23:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=e("./Errors");r.AbortError = n.AbortError,r.HttpError = n.HttpError,r.TimeoutError = n.TimeoutError;var o=e("./HttpClient");r.HttpClient = o.HttpClient,r.HttpResponse = o.HttpResponse;var i=e("./DefaultHttpClient");r.DefaultHttpClient = i.DefaultHttpClient;var s=e("./HubConnection");r.HubConnection = s.HubConnection,r.HubConnectionState = s.HubConnectionState;var a=e("./HubConnectionBuilder");r.HubConnectionBuilder = a.HubConnectionBuilder;var c=e("./IHubProtocol");r.MessageType = c.MessageType;var u=e("./ILogger");r.LogLevel = u.LogLevel;var l=e("./ITransport");r.HttpTransportType = l.HttpTransportType,r.TransferFormat = l.TransferFormat;var h=e("./Loggers");r.NullLogger = h.NullLogger;var f=e("./JsonHubProtocol");r.JsonHubProtocol = f.JsonHubProtocol;var p=e("./Subject");r.Subject = p.Subject;var g=e("./Utils");r.VERSION = g.VERSION;},{"./DefaultHttpClient":2,"./Errors":4,"./HttpClient":7,"./HubConnection":9,"./HubConnectionBuilder":10,"./IHubProtocol":11,"./ILogger":12,"./ITransport":13,"./JsonHubProtocol":14,"./Loggers":15,"./Subject":18,"./Utils":20}],24:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Hub = void 0;var n=e("./Logger.js"),o=e("@microsoft/signalr"),i=(function(){function e(e){var t=this;this.log = new n.Log(),this.connection = new o.HubConnectionBuilder().withUrl("/viewDataHub").configureLogging(o.LogLevel.Error).build(),this.connection.on("Received",function(t){e.received(t);}),this.connection.on("stats",function(t){e.stats(t);}),this.connection.on("exception",function(t){e.exception(t);}),this.Server = {services:function services(){return t.connection.invoke("Services");},isOpen:function isOpen(){return t.connection.invoke("IsOpen");},open:function open(e){return t.connection.invoke("Open",e);},asyncWrite:function asyncWrite(e){return t.connection.invoke("AsyncWrite",e);},write:function write(e){return t.connection.invoke("Write",e);},asyncRead:function asyncRead(){return t.connection.invoke("AsyncRead");},read:function read(){return t.connection.invoke("Read");},close:function close(){return t.connection.invoke("Close");}};}return e.prototype.Connect = function(){var e=this;return new Promise(function(t,r){e.connection.state == o.HubConnectionState.Disconnected?e.connection.start().then(function(){e.log.Success("SignalR: started"),t();})["catch"](function(t){e.log.Success("SignalR: " + t),r(t);}):t();});},e;})();r.Hub = i;},{"./Logger.js":25,"@microsoft/signalr":23}],25:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Log = void 0;var n=(function(){function e(){}return e.prototype.Success = function(){for(var e=[],t=0;t < arguments.length;t++) e[t] = arguments[t];e.forEach(function(e){return console.log("vd-view: success: " + e);});},e.prototype.Info = function(){for(var e=[],t=0;t < arguments.length;t++) e[t] = arguments[t];e.forEach(function(e){return console.log("vd-view: info:  " + e);});},e.prototype.Error = function(){for(var e=[],t=0;t < arguments.length;t++) e[t] = arguments[t];e.forEach(function(e){return console.log("vd-view: error: " + e);});},e.prototype.Warning = function(){for(var e=[],t=0;t < arguments.length;t++) e[t] = arguments[t];e.forEach(function(e){return console.log("vd-view: warning: " + e);});},e;})();r.Log = n;},{}],26:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=e("./Views.js");window.vdView = {init:function init(){var e=new n.Main();ko.applyBindings(e);}};},{"./Views.js":33}],27:[function(e,t,r){"use strict";var n=this && this.__read || function(e,t){var r="function" == typeof Symbol && e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),s=[];try{for(;(void 0 === t || t-- > 0) && !(n = i.next()).done;) s.push(n.value);}catch(e) {o = {error:e};}finally {try{n && !n.done && (r = i["return"]) && r.call(i);}finally {if(o)throw o.error;}}return s;},o=this && this.__spread || function(){for(var e=[],t=0;t < arguments.length;t++) e = e.concat(n(arguments[t]));return e;};function i(e,t,r,n,o){var i=(function(){if(e < 0 || e > 15 || t < 0 || t > 7)return 32;if(2 == t && r)switch(e){case 3:return 163;default:return 32 + e;}else {if(2 == t && n)return (o?60928:60960) + e;if(3 == t && r)return 48 + e;if(3 == t && n)return (o?60944:60976) + e;if(4 == t)return 64 + e;if(5 == t)switch(e){case 11:return 8592;case 12:return 189;case 13:return 8594;case 14:return 8593;case 15:return 35;default:return 80 + e;}else if(6 == t && r)switch(e){case 0:return 8211;default:return 96 + e;}else {if(6 == t && n)return (o?60992:61024) + e;if(7 == t && r)switch(e){case 11:return 188;case 12:return 8214;case 13:return 190;case 14:return 247;case 15:return 9632;default:return 112 + e;}else if(7 == t && n)return (o?61008:61040) + e;}}return 32;})();return {code:i,char:String.fromCharCode(i),nativeCode:a(e,t)};}function s(e){var t=(e = e || r.Space).charCodeAt(0),n=0,o=0;switch(t){case 163:o = 2,n = 3;break;case 8592:o = 5,n = 11;break;case 189:o = 5,n = 12;break;case 8594:o = 5,n = 13;break;case 8593:o = 5,n = 14;break;case 35:o = 5,n = 15;break;case 8211:o = 6,n = 0;break;case 188:o = 7,n = 11;break;case 8214:o = 7,n = 12;break;case 190:o = 7,n = 13;break;case 247:o = 7,n = 14;break;case 9632:o = 7,n = 15;break;default:t >= 32 && t < 48?(o = 2,n = t - 32):t >= 60928 && t < 60944?(o = 2,n = t - 60928):t >= 60960 && t < 60976?(o = 2,n = t - 60960):t >= 48 && t < 64?(o = 3,n = t - 48):t >= 60944 && t < 60960?(o = 3,n = t - 60944):t >= 60976 && t < 60992?(o = 3,n = t - 60976):t >= 64 && t < 80?(o = 4,n = t - 64):t >= 80 && t < 96?(o = 5,n = t - 80):t >= 96 && t < 112?(o = 6,n = t - 96):t >= 60992 && t < 61008?(o = 6,n = t - 60992):t >= 61024 && t < 61040?(o = 6,n = t - 61024):t >= 112 && t < 128?(o = 7,n = t - 112):t >= 61008 && t < 61024?(o = 7,n = t - 61008):t >= 61040 && t < 61056?(o = 7,n = t - 61040):(o = 2,n = 0);}return {colCode:o,rowCode:n,code:a(n,o),char:i(n,o,!0,!1,!1).char};}function a(e,t){return (t << 4) + e & 127;}Object.defineProperty(r,"__esModule",{value:!0}),r.IsMosaic = r.FromKeyboardString = r.FromKeyboard = r.ToDisplay = r.Space = void 0,r.Space = " ",r.ToDisplay = i,r.FromKeyboard = s,r.FromKeyboardString = function(e){return o(String(e || "")).map(function(e){return e.charCodeAt(0) < 32?e:String.fromCharCode(s(e).code);}).join("");},r.IsMosaic = function(e){switch(s(e).colCode){case 2:case 3:case 6:case 7:return !0;}return !1;};},{}],28:[function(e,t,r){"use strict";var n=this && this.__read || function(e,t){var r="function" == typeof Symbol && e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),s=[];try{for(;(void 0 === t || t-- > 0) && !(n = i.next()).done;) s.push(n.value);}catch(e) {o = {error:e};}finally {try{n && !n.done && (r = i["return"]) && r.call(i);}finally {if(o)throw o.error;}}return s;},o=this && this.__spread || function(){for(var e=[],t=0;t < arguments.length;t++) e = e.concat(n(arguments[t]));return e;};Object.defineProperty(r,"__esModule",{value:!0}),r.SAA5050 = void 0;var i=e("./Terminal.js"),s=e("./Mode7.js"),a=(function(){function e(e){var t=this;this.displayBuffer = e,this.flags = new c(),this.afterFlags = new u(),this.bufferRowIdx = 0,this.bufferColIdx = 0,this.doubleHeightLowerRowIdx = -1,this.lastCharacter = null,this.frameBufferMax = 2e3,this.frameBuffer = new Uint8Array(this.frameBufferMax),this.frameBufferOffset = 0,this.headerRow = Array(i.Constants.MaxCols),this.Flags = {IsEscaped:ko.computed(function(){return t.flags.IsEscaped();}),IsContiguous:ko.computed(function(){return t.flags.IsContiguous();}),IsCursorOn:ko.computed(function(){return t.flags.IsCursorOn();}),IsDoubleHeight:ko.computed(function(){return t.flags.IsDoubleHeight();}),IsConcealed:ko.computed(function(){return t.flags.IsConcealed();}),IsFlashing:ko.computed(function(){return t.flags.IsFlashing();}),IsAlpha:ko.computed(function(){return t.flags.IsAlpha();}),IsGraphics:ko.computed(function(){return !t.flags.IsAlpha();}),AlphaFgColour:ko.computed(function(){return t.flags.AlphaFgColour();}),MosaicFgColour:ko.computed(function(){return t.flags.MosaicFgColour();}),BgColour:ko.computed(function(){return t.flags.BgColour();}),IsMosaicHeld:ko.computed(function(){return t.flags.IsMosaicHeld();}),HeldMosaic:ko.computed(function(){return t.flags.IsMosaicHeld()?t.flags.HeldMosaic():null;})},new Array().fill(0),this.headerRow.fill(s.Space);}return e.prototype.DecodeBase64 = function(e){var t=Uint8Array.from(atob(e),function(e){return e.charCodeAt(0);});return this.DecodeBytes(t);},e.prototype.DecodeBytes = function(e){for(var t=0;t < e.length && this.bufferRowIdx < i.Constants.MaxRows;++t) {var r=e[t];switch((this.frameBufferOffset < this.frameBufferMax && this.frameBuffer.set([r],this.frameBufferOffset++),r)){case 0:continue;case 8:--this.bufferColIdx,this.bufferColIdx < 0 && (this.bufferColIdx = i.Constants.MaxCols - 1,--this.bufferRowIdx,this.bufferRowIdx < 0 && (this.bufferRowIdx = i.Constants.MaxRows - 1));continue;case 9:++this.bufferColIdx,this.bufferColIdx >= i.Constants.MaxCols && (this.bufferColIdx = 0,++this.bufferRowIdx,this.bufferRowIdx >= i.Constants.MaxRows && (this.bufferRowIdx = 0));continue;case 10:this.nextRow();continue;case 11:--this.bufferRowIdx,this.bufferRowIdx < 0 && (this.bufferRowIdx = i.Constants.MaxRows - 1);continue;case 12:this.newFrame();continue;case 13:this.fillEnd(),this.bufferColIdx = 0;continue;case 17:this.flags.IsCursorOn(!0);continue;case 20:this.flags.IsCursorOn(!1),this.displayBuffer.CursorOff();continue;case 30:this.fillEnd(),this.bufferColIdx = 0,this.bufferRowIdx = 0;continue;}var n=15 & r,o=(112 & r) >> 4;if((this.flags.IsEscaped() && (o &= 1,this.flags.IsEscaped(!1)),0 == o))switch(n){case 0:break;case 8:this.afterFlags.isFlashing = !0;break;case 9:this.flags.IsFlashing(!1);break;case 10:this.afterFlags.isBoxing = !1;break;case 11:this.afterFlags.isBoxing = !0;break;case 12:this.flags.IsDoubleHeight(!1),this.flags.HeldMosaic(s.Space);break;case 13:this.bufferRowIdx < i.Constants.MaxRows - 2 && (this.afterFlags.isDoubleHeight = !0);break;case 14:case 15:break;default:this.afterFlags.alphaFgColour = n;}else if(1 == o)switch(n){case 0:break;case 8:this.flags.IsConcealed(!0);break;case 9:this.flags.IsContiguous(!0);break;case 10:this.flags.IsContiguous(!1);break;case 11:this.flags.IsEscaped(!0);continue;case 12:this.flags.BgColour(0);break;case 13:this.flags.BgColour(this.flags.IsAlpha()?this.flags.AlphaFgColour():this.flags.MosaicFgColour());break;case 14:this.flags.IsMosaicHeld(!0);break;case 15:this.afterFlags.isMosaicHeld = !1;break;default:this.afterFlags.mosaicFgColour = n;}if(this.bufferRowIdx != this.doubleHeightLowerRowIdx){var a=this.displayBuffer.Cell(this.bufferRowIdx,this.bufferColIdx);if((a.Fg = this.flags.IsAlpha()?this.flags.AlphaFgColour():this.flags.MosaicFgColour(),a.Bg(this.flags.BgColour()),a.IsFlashing(this.flags.IsFlashing()),a.IsConcealed(this.flags.IsConcealed()),a.IsDoubleHeight(this.flags.IsDoubleHeight()),this.flags.IsDoubleHeight())){var c=this.displayBuffer.Cell(this.doubleHeightLowerRowIdx,this.bufferColIdx);c.Bg(this.flags.BgColour()),c.IsFlashing(this.flags.IsFlashing()),c.IsConcealed(this.flags.IsConcealed());}0 == o || 1 == o?(a.SetCharacter(this.flags.IsMosaicHeld()?this.flags.HeldMosaic():s.Space,this.flags.IsMosaicHeld() && this.flags.IsHeldMosaicContiguous()),0 == this.bufferRowIdx && (this.headerRow[this.bufferColIdx] = s.Space)):(this.lastCharacter = this.getChar(n,o),a.SetCharacter(this.lastCharacter,!this.flags.IsAlpha() && this.flags.IsContiguous()),this.flags.IsAlpha() || (this.flags.HeldMosaic(this.lastCharacter),this.flags.IsHeldMosaicContiguous(this.flags.IsContiguous())),0 == this.bufferRowIdx && (this.headerRow[this.bufferColIdx] = this.lastCharacter));}this.flags.SetAfterFlags(this.afterFlags),this.afterFlags.isDoubleHeight && (this.doubleHeightLowerRowIdx = this.bufferRowIdx + 1,this.displayBuffer.Rows[this.doubleHeightLowerRowIdx].SetIsDoubleHeightLowerRow()),this.afterFlags.Reset(),++this.bufferColIdx,this.bufferColIdx == i.Constants.MaxCols && this.nextRow();}return this.displayBuffer.CursorOff(),this.flags.IsCursorOn() && this.displayBuffer.CursorOn(this.bufferRowIdx,this.bufferColIdx),e.length;},e.prototype.Reset = function(){this.newFrame(),this.flags.IsCursorOn(!1),this.displayBuffer.ResetCursor();},e.prototype.Load = function(e){this.Reset(),this.DecodeBase64(e);},e.prototype.GetFrameAsBase64 = function(){return btoa(String.fromCharCode.apply(String,o(this.frameBuffer.slice(0,this.frameBufferOffset))));},e.prototype.FrameNumber = function(){var e=this.headerRow.join("").match(/ P?(\d+)|(\d+[a-z]) /);return e && e.length > 1?e[1]:"0";},e.prototype.newFrame = function(){this.bufferRowIdx = this.bufferColIdx = 0,this.flags.Reset(),this.afterFlags.Reset(),this.displayBuffer.Reset(),this.frameBufferOffset = 0,this.doubleHeightLowerRowIdx = -1,this.headerRow.fill(s.Space);},e.prototype.nextRow = function(){this.bufferRowIdx + 1 < i.Constants.MaxRows?++this.bufferRowIdx:this.bufferRowIdx = 0,this.bufferColIdx = 0,this.flags.Reset(),this.afterFlags.Reset();},e.prototype.fillEnd = function(){if(this.bufferColIdx > 0)for(var e=this.displayBuffer.Cell(this.bufferRowIdx,this.bufferColIdx - 1),t=this.bufferColIdx;t < i.Constants.MaxCols;++t) {var r=this.displayBuffer.Cell(this.bufferRowIdx,t);r.Fg = e.Fg,r.Bg(e.Bg()),r.IsFlashing(e.IsFlashing()),r.IsConcealed(e.IsConcealed()),r.IsDoubleHeight(e.IsDoubleHeight());}},e.prototype.getChar = function(e,t){return s.ToDisplay(e,t,this.flags.IsAlpha(),!this.flags.IsAlpha(),this.flags.IsContiguous()).char;},e;})();r.SAA5050 = a;var c=(function(){function e(){this.BgColour = ko.observable(i.Colours.black),this.AlphaFgColour = ko.observable(i.Colours.white),this.MosaicFgColour = ko.observable(i.Colours.white),this.IsAlpha = ko.observable(!0),this.IsContiguous = ko.observable(!0),this.IsFlashing = ko.observable(!1),this.IsEscaped = ko.observable(!1),this.IsBoxing = ko.observable(!1),this.IsConcealed = ko.observable(!1),this.IsMosaicHeld = ko.observable(!1),this.HeldMosaic = ko.observable(s.Space),this.IsHeldMosaicContiguous = ko.observable(!1),this.IsDoubleHeight = ko.observable(!1),this.IsCursorOn = ko.observable(!1);}return e.prototype.Reset = function(){this.BgColour(i.Colours.black),this.AlphaFgColour(i.Colours.white),this.IsAlpha(!0),this.IsFlashing(!1),this.IsEscaped(!1),this.IsBoxing(!1),this.IsConcealed(!1),this.IsContiguous(!0),this.IsMosaicHeld(!1),this.HeldMosaic(s.Space),this.IsHeldMosaicContiguous(!1),this.IsDoubleHeight(!1);},e.prototype.SetAfterFlags = function(e){var t=this.IsAlpha();null != e.alphaFgColour?(this.AlphaFgColour(e.alphaFgColour),this.IsAlpha(!0),this.IsConcealed(!1)):null != e.mosaicFgColour && (this.MosaicFgColour(e.mosaicFgColour),this.IsAlpha(!1),this.IsConcealed(!1)),this.IsAlpha() != t && (this.HeldMosaic(s.Space),this.IsHeldMosaicContiguous(!1)),!0 === e.isFlashing && this.IsFlashing(!0),null != e.isBoxing && this.IsBoxing(!!e.isBoxing),!1 === e.isMosaicHeld && (this.IsMosaicHeld(!1),this.IsHeldMosaicContiguous(!1)),!0 === e.isDoubleHeight && this.IsDoubleHeight(!0);},e;})(),u=(function(){function e(){this.alphaFgColour = null,this.mosaicFgColour = null,this.isFlashing = null,this.isBoxing = null,this.isMosaicHeld = null,this.isDoubleHeight = null;}return e.prototype.Reset = function(){this.alphaFgColour = null,this.mosaicFgColour = null,this.isFlashing = null,this.isBoxing = null,this.isMosaicHeld = null,this.isDoubleHeight = null;},e;})();},{"./Mode7.js":27,"./Terminal.js":32}],29:[function(e,t,r){"use strict";var n=this && this.__generator || function(e,t){var r,n,o,i,s={label:0,sent:function sent(){if(1 & o[0])throw o[1];return o[1];},trys:[],ops:[]};return i = {next:a(0),"throw":a(1),"return":a(2)},"function" == typeof Symbol && (i[Symbol.iterator] = function(){return this;}),i;function a(i){return function(a){return (function(i){if(r)throw new TypeError("Generator is already executing.");for(;s;) try{if((r = 1,n && (o = 2 & i[0]?n["return"]:i[0]?n["throw"] || ((o = n["return"]) && o.call(n),0):n.next) && !(o = o.call(n,i[1])).done))return o;switch((n = 0,o && (i = [2 & i[0],o.value]),i[0])){case 0:case 1:o = i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,n = i[1],i = [0];continue;case 7:i = s.ops.pop(),s.trys.pop();continue;default:if(!(o = s.trys,(o = o.length > 0 && o[o.length - 1]) || 6 !== i[0] && 2 !== i[0])){s = 0;continue;}if(3 === i[0] && (!o || i[1] > o[0] && i[1] < o[3])){s.label = i[1];break;}if(6 === i[0] && s.label < o[1]){s.label = o[1],o = i;break;}if(o && s.label < o[2]){s.label = o[2],s.ops.push(i);break;}o[2] && s.ops.pop(),s.trys.pop();continue;}i = t.call(e,s);}catch(e) {i = [6,e],n = 0;}finally {r = o = 0;}if(5 & i[0])throw i[1];return {value:i[0]?i[1]:void 0,done:!0};})([i,a]);};}},o=this && this.__read || function(e,t){var r="function" == typeof Symbol && e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),s=[];try{for(;(void 0 === t || t-- > 0) && !(n = i.next()).done;) s.push(n.value);}catch(e) {o = {error:e};}finally {try{n && !n.done && (r = i["return"]) && r.call(i);}finally {if(o)throw o.error;}}return s;},i=this && this.__spread || function(){for(var e=[],t=0;t < arguments.length;t++) e = e.concat(o(arguments[t]));return e;};Object.defineProperty(r,"__esModule",{value:!0}),r.Storage = r.Download = r.Frame = void 0;var s=e("./Terminal.js"),a=e("./Views.js"),c=function c(e){this.b64 = e.b64,this.thumbnail = e.thumbnail,this.uri = "data:" + e.thumbnail.mime + ";base64," + e.thumbnail.b64;};r.Frame = c;var u=function u(e){this.filename = e.filename,this.size = e.size,this.b64 = e.b64,this.mime = e.mime,this.uri = "data:" + e.mime + ";base64," + e.b64;};r.Download = u;var l=(function(){function e(){this.MimeTypes = {Binary:"application/octet-stream",ImagePng:"image/png"},this.frameKeyPrefix = /^SF_([0-9]+)$/,this.downloadKeyPrefix = /^DL_(.+)$/,this.storage = window.localStorage,this.frameKeys = i(this.getKeys(this.frameKeyPrefix)),this.downloadKeys = i(this.getKeys(this.downloadKeyPrefix)),this.frameKeys.sort(),this.downloadKeys.sort();}return Object.defineProperty(e.prototype,"EnableFlashing",{get:function get(){return "true" == this.storage.getItem("EnableFlashing");},set:function set(e){this.storage.setItem("EnableFlashing",String(!0 === e));},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"MessageSequenceNumber",{get:function get(){return Number(this.storage.getItem("MessageSequenceNumber")) || 0;},set:function set(e){this.storage.setItem("MessageSequenceNumber",String(e));},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"Version",{get:function get(){return Number(this.storage.getItem("Version")) || 0;},set:function set(e){this.storage.setItem("Version",String(e));},enumerable:!1,configurable:!0}),e.prototype.Frames = function(){var e=this;return this.frameKeys.map(function(t){try{return new c(JSON.parse(e.storage.getItem(t)));}catch(r) {e.storage.removeItem(t);}return null;}).filter(function(e){return null != e;});},e.prototype.GetFrameAt = function(e){return new c(JSON.parse(this.storage.getItem(this.frameKeys[e])));},e.prototype.RemoveFrameAt = function(e){this.storage.removeItem(this.frameKeys[e]),this.frameKeys.splice(e,1);},e.prototype.AddFrame = function(e,t){var r="SF_" + this.getSeqNo(),n={b64:e,thumbnail:t};return this.storage.setItem(r,JSON.stringify(n)),this.frameKeys.push(r),new c(n);},e.prototype.Downloads = function(){var e=this;return this.downloadKeys.map(function(t){try{return new u(JSON.parse(e.storage.getItem(t)));}catch(r) {e.storage.removeItem(t);}return null;}).filter(function(e){return null != e;});},e.prototype.RemoveDownloadAt = function(e){this.storage.removeItem(this.downloadKeys[e]),this.downloadKeys.splice(e,1);},e.prototype.AddDownload = function(e,t,r,n){void 0 === n && (n = this.MimeTypes.Binary);var o="DL_" + e + "_" + this.getSeqNo(),i={filename:e,size:t,b64:r,mime:n};return this.storage.setItem(o,JSON.stringify(i)),this.downloadKeys.push(o),new u(i);},e.prototype.Migrate = function(){var e=this;if((0 == this.Version && ("true" == this.storage.getItem("HelpDismissed") && (this.MessageSequenceNumber = 1),this.storage.removeItem("HelpDismissed"),this.Version = 1),1 == this.Version && (this.downloadKeys.forEach(function(t){var r=JSON.parse(e.storage.getItem(t));r.hasOwnProperty("mime") || (r.mime = e.MimeTypes.Binary),e.storage.setItem(t,JSON.stringify(r));}),this.Version = 2),2 == this.Version)){var t=document.getElementById("Canvas"),r=new a.ViewDataView();this.frameKeys.forEach(function(n){var o=e.storage.getItem(n);r.Decoder.Load(o);var i=s.SaveAsImage(r.Buffer,t,160,125);e.storage.setItem(n,JSON.stringify({b64:o,thumbnail:i}));}),this.Version = 3;}3 == this.Version && (this.storage.removeItem("MessageSequenceNumber"),this.Version = 4);},e.prototype.getKeys = function(e){var t,r;return n(this,function(n){switch(n.label){case 0:t = 0,n.label = 1;case 1:return t < this.storage.length?(r = this.storage.key(t),e.test(r)?[4,r]:[3,3]):[3,4];case 2:n.sent(),n.label = 3;case 3:return ++t,[3,1];case 4:return [2];}});},e.prototype.getSeqNo = function(){return Date.now() + Math.floor(10 * Math.random());},e;})();r.Storage = l;},{"./Terminal.js":32,"./Views.js":33}],30:[function(e,t,r){"use strict";var n=this && this.__read || function(e,t){var r="function" == typeof Symbol && e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),s=[];try{for(;(void 0 === t || t-- > 0) && !(n = i.next()).done;) s.push(n.value);}catch(e) {o = {error:e};}finally {try{n && !n.done && (r = i["return"]) && r.call(i);}finally {if(o)throw o.error;}}return s;},o=this && this.__spread || function(){for(var e=[],t=0;t < arguments.length;t++) e = e.concat(n(arguments[t]));return e;};Object.defineProperty(r,"__esModule",{value:!0}),r.SvgBufferCell = r.SvgBufferRow = r.SvgBufferTransform = void 0;var i=e("./Terminal.js"),s=e("./Mode7.js"),a=(function(){function e(){}return e.CellHeight = 20,e.CellDoubleHeight = 40,e.CellWidth = 15,e.FontDescender = 4,e.DoubleFontDescender = 8,e;})(),c=(function(){function e(e,t){this.buffer = e,this.ShowGrid = t,this.Rows = o(e.Rows,[e.StatusRow]).map(function(e,t,r){return new u(r,t);}),this.ViewBox = ko.computed(function(){return "0 0 " + i.Constants.MaxCols * a.CellWidth + " " + (i.Constants.MaxRows + 1) * a.CellHeight;}),this.Grid = this.getGridLines();}return e.prototype.getGridLines = function(){for(var e=i.Constants.MaxCols * a.CellWidth,t=i.Constants.MaxRows * a.CellHeight,r=new Array(),n=0;n <= i.Constants.MaxCols;++n) {var o=n * a.CellWidth,s=n > 0 && n < i.Constants.MaxCols && n % 10 == 0;r.push({X1:o,Y1:0,X2:o,Y2:t - 1,Css:"gcol " + (s?"gcol-10":"")});}for(var c=0;c <= i.Constants.MaxRows;++c) {var u=c * a.CellHeight;s = c > 0 && c < i.Constants.MaxRows && c % 10 == 0;r.push({X1:0,Y1:u,X2:e - 1,Y2:u,Css:"grow " + (s?"grow-10":"")});}return r;},e;})();r.SvgBufferTransform = c;var u=function u(e,t){var r=this;this.bufferRows = e,this.RowIdx = t,this.myBufferRow = this.bufferRows[this.RowIdx],this.IsHidden = this.myBufferRow.IsHidden,this.Y = ko.computed(function(){return r.RowIdx * a.CellHeight;}),this.IsAnyDoubleHeight = ko.computed(function(){return r.myBufferRow.Cells.some(function(e){return e.IsDoubleHeight();});}),this.RowHeight = ko.computed(function(){return r.IsHidden()?0:r.IsAnyDoubleHeight()?a.CellDoubleHeight:a.CellHeight;}),this.Cells = this.myBufferRow.Cells.map(function(e,t){return new l(r,e,t);});};r.SvgBufferRow = u;var l=function l(e,t,r){var n=this;this.row = e,this.bufferCell = t,this.colIdx = r,this.Character = this.bufferCell.Character,this.FontDescender = ko.computed(function(){return n.bufferCell.IsDoubleHeight()?a.DoubleFontDescender:a.FontDescender;}),this.FontSize = ko.computed(function(){return "" + (n.bufferCell.IsDoubleHeight()?a.CellDoubleHeight:a.CellHeight);}),this.Width = ko.observable(a.CellWidth),this.CellHeight = ko.computed(function(){return n.row.IsHidden()?0:n.bufferCell.IsDoubleHeight()?a.CellDoubleHeight:a.CellHeight;}),this.X = ko.observable(this.colIdx * a.CellWidth),this.TextX = ko.computed(function(){return n.X() - 1;}),this.Y = this.row.Y,this.TextY = ko.computed(function(){return n.row.IsHidden()?0:n.Y() + n.CellHeight() - n.FontDescender();}),this.CellCss = ko.computed(function(){var e=n.bufferCell.IsContiguousMosaic() && s.IsMosaic(n.Character());return "svg-viewdata-view-cell " + (n.bufferCell.IsFlashing()?"blink":"") + " " + (n.bufferCell.IsDoubleHeight()?"double-height":"") + " " + (n.bufferCell.IsConcealed()?"concealed":"") + " " + (e?"mosaic":"");}),this.BgCss = ko.computed(function(){return "bg-" + (n.bufferCell.IsCursor()?i.Colours[i.Colours.white]:i.Colours[n.bufferCell.Bg()]);}),this.FgCss = ko.computed(function(){return "fg-" + (n.bufferCell.IsCursor()?i.Colours[i.Colours.black]:i.Colours[n.bufferCell.Fg]);}),this.Id = ko.computed(function(){return "row-" + n.row.RowIdx + "-col-" + n.colIdx;}),this.Fixes = ko.computed(function(){var e=new Array();return n.bufferCell.IsContiguousMosaic() && s.IsMosaic(n.Character()) && e.push({X:n.TextX(),Y:n.TextY() - 2}),e;});};r.SvgBufferCell = l;},{"./Mode7.js":27,"./Terminal.js":32}],31:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Downloads = void 0;var n=(function(){function e(){this.buffer = new Array();}return e.prototype.Reset = function(){this.buffer.length = 0;},e.prototype.Write = function(e){this.buffer.push(String.fromCharCode(e));},e.prototype.Length = function(){return this.buffer.length;},e.prototype.GetBase64 = function(){return btoa(this.buffer.join(""));},e;})(),o=(function(){function e(e,t,r){this.onError = e,this.onEndOfFrame = t,this.onEndOfFile = r,this.threeQuarters = 125,this.space = 32,this.bar = 124,this.outputBuffer = new n(),this.state = 0,this.frameNumber = 0,this.runningChecksum = 0,this.checksum = 0,this.frameLetter = null,this.shiftOffset = 0,this.controlCode = null,this.ignore = !1,this.inFrame = !1,this.filename = "";}return e.prototype.Reset = function(){this.outputBuffer.Reset(),this.state = 0,this.frameNumber = 0,this.runningChecksum = 0,this.checksum = 0,this.frameLetter = null,this.shiftOffset = 0,this.controlCode = null,this.ignore = !1,this.inFrame = !1,this.filename = "";},e.prototype.TryDecodeHeaderFrame = function(e){return this.Decode(e,!1),1 === this.frameNumber && !!this.filename;},e.prototype.Decode = function(e,t,r){void 0 === t && (t = !0),void 0 === r && (r = !1);for(var n=Uint8Array.from(atob(e),function(e){return e.charCodeAt(0);}),o=0;o < n.length;++o) {var i=n[o];if((r && this.inFrame && this.parity(i) !== i >> 7 && this.onError("parity error in frame " + this.frameNumber),(i &= 127) != this.bar)){var s=String.fromCharCode(i);if(this.inFrame && 0 === this.state)this.runningChecksum ^= i,this.ignore || (1 === this.frameNumber?"I" === this.controlCode && (this.filename += s):i == this.threeQuarters?this.outputBuffer.Write(this.space + this.shiftOffset):this.outputBuffer.Write(i + this.shiftOffset));else if(this.state >= 1)switch((1 === this.state && (this.controlCode = s,"A" !== this.controlCode && "Z" !== this.controlCode && (this.runningChecksum ^= 124,this.runningChecksum ^= i)),this.controlCode)){case "0":this.shiftOffset = 0,this.state = 0;continue;case "1":this.shiftOffset = -64,this.state = 0;continue;case "2":this.shiftOffset = 64,this.state = 0;continue;case "3":this.shiftOffset = 96,this.state = 0;continue;case "4":this.shiftOffset = 128,this.state = 0;continue;case "5":this.shiftOffset = 160,this.state = 0;continue;case String.fromCharCode(this.threeQuarters):this.outputBuffer.Write(this.threeQuarters + this.shiftOffset),this.state = 0;continue;case "A":++this.frameNumber,this.runningChecksum = 0,this.state = 0,this.inFrame = !0;continue;case "D":this.state = 0;continue;case "E":this.outputBuffer.Write(this.bar + this.shiftOffset),this.state = 0;continue;case "F":t && this.onEndOfFile && this.onEndOfFile(this.filename,this.outputBuffer.Length()),this.state = 0,this.inFrame = !1;continue;case "G":switch(this.state){case 1:++this.state;break;case 2:this.runningChecksum ^= i,this.frameLetter = String.fromCharCode(i),this.state = 0,this.ignore = !0;}continue;case "I":this.ignore = !1,this.state = 0;continue;case "L":this.state = 0,1 === this.frameNumber?this.ignore = !0:this.outputBuffer.Write(13);continue;case "T":this.state = 0;continue;case "Z":switch(this.state){case 1:this.checksum = 0,++this.state,this.inFrame = !1;break;case 2:this.checksum += 100 * (i - 48),++this.state;break;case 3:this.checksum += 10 * (i - 48),++this.state;break;case 4:this.checksum += i - 48,this.checksum !== this.runningChecksum && this.onError("invalid frame checksum at frame " + this.frameNumber + " (expected " + this.checksum + ", got " + this.runningChecksum + ")"),this.state = 0,t && this.onEndOfFrame && this.onEndOfFrame(this.frameLetter || "");}continue;default:this.ignore = !0,this.state = 0;continue;}}else this.state = 1;}return n.length;},e.prototype.GetBase64 = function(){return this.outputBuffer.GetBase64();},e.prototype.parity = function(e){return ((1 & e) + (e >> 1 & 1) + (e >> 2 & 1) + (e >> 3 & 1) + (e >> 4 & 1) + (e >> 5 & 1) + (e >> 6 & 1)) % 2;},e;})();r.Downloads = o;},{}],32:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.SaveAsImage = r.Position = r.Input = r.Clock = r.Cell = r.Row = r.Buffer = r.Constants = r.ControlKeys = r.Colours = void 0;var n,o,i=e("./Mode7.js");!(function(e){e[e.black = 0] = "black",e[e.red = 1] = "red",e[e.green = 2] = "green",e[e.yellow = 3] = "yellow",e[e.blue = 4] = "blue",e[e.magenta = 5] = "magenta",e[e.cyan = 6] = "cyan",e[e.white = 7] = "white";})(n = r.Colours || (r.Colours = {})),(function(e){e.Reveal = "REVEAL",e.Advance = "ADVANCE",e.Hold = "HOLD",e.Download = "DOWNLOAD";})(o = r.ControlKeys || (r.ControlKeys = {}));var s=(function(){function e(){}return e.MaxCols = 40,e.MaxRows = 24,e;})();r.Constants = s;var a=(function(){function e(){this.Rows = new Array(s.MaxRows),this.StatusRow = new c(),this.Cursor = new f({row:0,col:0});for(var e=0;e < s.MaxRows;++e) this.Rows[e] = new c();this.CursorOff();}return e.prototype.Reset = function(){this.Rows.forEach(function(e){return e.Reset();}),this.CursorOff();},e.prototype.Row = function(e){return this.Rows[e];},e.prototype.Cell = function(e,t){return this.Rows[e].Cells[t];},e.prototype.CellAtPosition = function(e){return this.Rows[e.Row()].Cells[e.Column()];},e.prototype.CursorOff = function(){this.CellAtPosition(this.Cursor).IsCursor(!1);},e.prototype.CursorOn = function(e,t){this.Cursor.Row(e),this.Cursor.Column(t),this.CellAtPosition(this.Cursor).IsCursor(!0);},e.prototype.ResetCursor = function(){this.CursorOff(),this.Cursor.Row(0),this.Cursor.Column(0);},e.prototype.SetStatusRow = function(e,t,r){void 0 === t && (t = n.white),void 0 === r && (r = n.black);var o=0;if(null !== e)for(e.length > s.MaxCols && (e = e.substring(0,s.MaxCols));o < e.length;++o) {var a=this.StatusRow.Cells[o],c=i.FromKeyboard(e[o]).char;a.Fg = t,a.Bg(r),a.Character(c);}for(;o < s.MaxCols;) {(a = this.StatusRow.Cells[o]).Fg = t,a.Bg(r),a.Character(i.Space),++o;}},e;})();r.Buffer = a;var c=(function(){function e(){this.Cells = new Array(s.MaxRows),this.IsHidden = ko.observable(!1);for(var e=0;e < s.MaxCols;++e) this.Cells[e] = new u();}return e.prototype.Reset = function(){this.Cells.forEach(function(e){return e.Reset();}),this.IsHidden(!1);},e.prototype.SetIsDoubleHeightLowerRow = function(){this.IsHidden(!0);},e;})();r.Row = c;var u=(function(){function e(){var e=this;this._fg = ko.observable(n.white),this._cachedFg = n.white,this.Character = ko.observable(i.Space),this.Bg = ko.observable(n.black),this.IsFlashing = ko.observable(!1),this.IsConcealed = ko.observable(!1),this.IsDoubleHeight = ko.observable(!1),this.IsCursor = ko.observable(!1),this.IsContiguousMosaic = ko.observable(!1),this.Css = ko.computed(function(){return "bg-" + n[e.Bg()] + " fg-" + n[e._fg()] + " " + (e.IsFlashing()?"blink":"") + " " + (e.IsDoubleHeight()?"double-height":"") + " " + (e.IsConcealed()?"concealed":"") + " " + (e.IsCursor()?"cursor":"") + " " + (e.IsContiguousMosaic()?"mosaic":"");}),l.Enlist(function(t){e.IsFlashing() && (t?e._fg(e._cachedFg):e._fg(e.Bg()));});}return Object.defineProperty(e.prototype,"Fg",{get:function get(){return this._fg();},set:function set(e){this._fg(e),this._cachedFg = e;},enumerable:!1,configurable:!0}),e.prototype.Reset = function(){this.Character(i.Space),this.Bg(0),this.Fg = n.white,this.IsFlashing(!1),this.IsConcealed(!1),this.IsDoubleHeight(!1),this.IsCursor(!1),this.IsContiguousMosaic(!1);},e.prototype.SetCharacter = function(e,t){void 0 === t && (t = !1),this.Character(e),this.IsContiguousMosaic(t);},e;})();r.Cell = u;var l=(function(){function e(){}return e.Enlist = function(t){e.callbacks.push(t);},e.Start = function(){e.show = !1,e.clock = window.setInterval(function(){e.callbacks.forEach(function(t){t(e.show);}),e.show = !e.show;},1e3);},e.Stop = function(){0 != e.clock && (window.clearInterval(e.clock),e.clock = 0),e.callbacks.forEach(function(e){e(!0);});},e.callbacks = new Array(),e.show = !1,e.clock = 0,e;})();r.Clock = l;var h=function h(e,t){var r=this;this.onAlt = e,this.onChar = t,this.OnKeyDown = function(e,t){var n=t.originalEvent;if(n.altKey)switch(n.key){case "R":case "r":r.onAlt(o.Reveal);break;case "A":case "a":r.onAlt(o.Advance);break;case "H":case "h":r.onAlt(o.Hold);break;case "D":case "d":r.onAlt(o.Download);}else switch(n.key){case "ArrowLeft":case "Left":case "Backspace":r.onChar("\b");break;case "ArrowRight":case "Right":r.onChar("\t");break;case "ArrowUp":case "Up":r.onChar("\v");break;case "ArrowDown":case "Down":r.onChar("\n");break;case "Delete":r.onChar(String.fromCharCode(127));break;case "Enter":r.onChar("_");break;case "Escape":r.onChar(String.fromCharCode(27));break;default:1 == n.key.length && ("#" == n.key?r.onChar("_"):r.onChar(n.key));}};};r.Input = h;var f=function f(e){this.Row = ko.observable(e.row),this.Column = ko.observable(e.col);};r.Position = f,r.SaveAsImage = function(e,t,r,n){void 0 === r && (r = 600),void 0 === n && (n = 480);var o=["black","rgb(255, 0, 0)","rgb(0, 255, 0)","rgb(255, 255, 0)","rgb(0, 0, 255)","rgb(255, 0, 255)","rgb(0, 255, 255)","white"],i=Math.floor(r / s.MaxCols),a=Math.floor(n / s.MaxRows),c=2 * a;t.height = n,t.width = r;var u=t.getContext("2d");u.textBaseline = "bottom";for(var l=0,h=0,f=0;f < s.MaxRows;++f) if(!e.Row(f).IsHidden()){var p=e.Row(f).Cells.some(function(e){return e.IsDoubleHeight();});p?(h += c,u.font = c + "px bedstead-double-height"):(h += a,u.font = a + "px bedstead");for(var g=0;g < s.MaxCols;++g) {var d=e.Cell(f,g),b=g * i;u.fillStyle = o[d.Bg()],u.fillRect(b,l,i,p?c:a),u.fillStyle = o[d.Fg],u.fillText(d.Character(),b,h,i),d.IsContiguousMosaic() && u.fillText(d.Character(),b - 1,h,i);}l += p?c:a;}var v="data:image/png;base64,",y=t.toDataURL();return 0 == y.indexOf(v) && (y = y.substring(v.length)),{mime:"image/png",b64:y,size:4 * Math.ceil(y.length / 3),extension:".png"};};},{"./Mode7.js":27}],33:[function(e,t,r){"use strict";var n=this && this.__awaiter || function(e,t,r,n){return new (r || (r = Promise))(function(o,i){function s(e){try{c(n.next(e));}catch(e) {i(e);}}function a(e){try{c(n["throw"](e));}catch(e) {i(e);}}function c(e){var t;e.done?o(e.value):(t = e.value,t instanceof r?t:new r(function(e){e(t);})).then(s,a);}c((n = n.apply(e,t || [])).next());});},o=this && this.__generator || function(e,t){var r,n,o,i,s={label:0,sent:function sent(){if(1 & o[0])throw o[1];return o[1];},trys:[],ops:[]};return i = {next:a(0),"throw":a(1),"return":a(2)},"function" == typeof Symbol && (i[Symbol.iterator] = function(){return this;}),i;function a(i){return function(a){return (function(i){if(r)throw new TypeError("Generator is already executing.");for(;s;) try{if((r = 1,n && (o = 2 & i[0]?n["return"]:i[0]?n["throw"] || ((o = n["return"]) && o.call(n),0):n.next) && !(o = o.call(n,i[1])).done))return o;switch((n = 0,o && (i = [2 & i[0],o.value]),i[0])){case 0:case 1:o = i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,n = i[1],i = [0];continue;case 7:i = s.ops.pop(),s.trys.pop();continue;default:if(!(o = s.trys,(o = o.length > 0 && o[o.length - 1]) || 6 !== i[0] && 2 !== i[0])){s = 0;continue;}if(3 === i[0] && (!o || i[1] > o[0] && i[1] < o[3])){s.label = i[1];break;}if(6 === i[0] && s.label < o[1]){s.label = o[1],o = i;break;}if(o && s.label < o[2]){s.label = o[2],s.ops.push(i);break;}o[2] && s.ops.pop(),s.trys.pop();continue;}i = t.call(e,s);}catch(e) {i = [6,e],n = 0;}finally {r = o = 0;}if(5 & i[0])throw i[1];return {value:i[0]?i[1]:void 0,done:!0};})([i,a]);};}};Object.defineProperty(r,"__esModule",{value:!0}),r.Main = r.ViewDataView = void 0;var i=e("./Mullard.js"),s=e("./Terminal.js"),a=e("./Storage.js"),c=e("./Telesoft.js"),u=e("./Mode7.js"),l=e("./Hub.js"),h=e("./Logger.js"),f=e("./SvgRenderer.js"),p=function p(){this.Buffer = new s.Buffer(),this.IsRevealed = ko.observable(!1),this.ShowGrid = ko.observable(!1),this.EnableFlash = ko.observable(!1),this.Decoder = new i.SAA5050(this.Buffer),this.Constants = s.Constants,this.SVG = new f.SvgBufferTransform(this.Buffer,this.ShowGrid);};r.ViewDataView = p;var g=(function(){function e(){var e=this;this.defaultHeader = "Click 'Connect'",this.mainViewElement = document.getElementById("mainView"),this.downloadsElement = document.getElementById("downloads"),this.teletextCommands = {HOLD:"H",ADVANCE:"."},this.viewdataCommands = {NEXT:"#",PREVIOUS:"*#"},this.Header = ko.observable(this.defaultHeader),this.UserStats = ko.observable(null),this.Services = ko.observableArray(),this.SelectedService = ko.observable(),this.IsViewFocused = ko.observable(!0),this.IsConnected = ko.observable(!1),this.IsViewdata = ko.observable(!0),this.IsTeletext = ko.observable(!1),this.Postamble = ko.observable(null),this.Downloading = ko.observable(!1),this.Input = ko.observable(),this.Downloads = ko.observableArray(),this.SavedFrames = ko.observableArray(),this.EnableLogoff = ko.computed(function(){return e.IsConnected() && null != e.Postamble();}),this.EnableCommands = ko.computed(function(){return e.IsConnected() && !e.Downloading();}),this.EnableDownload = ko.observable(!1),this.Log = new h.Log(),this.View = new p(),this.Storage = new a.Storage(),this.Keyboard = new s.Input(function(t){switch(t){case s.ControlKeys.Hold:e.Command(e.teletextCommands.HOLD);break;case s.ControlKeys.Advance:e.Command(e.teletextCommands.ADVANCE);break;case s.ControlKeys.Reveal:e.ToggleReveal();break;case s.ControlKeys.Download:e.Download();}},function(t){e.Command(t);}),this.Downloader = new c.Downloads(function(t){e.Status.unexpected(),e.Log.Error(t);},function(t){e.send("z" == t?"0":"#");},function(t,r){e.Downloading(!1),e.EnableDownload(!1);var n=e.Downloader.GetBase64();e.Downloads.push(e.Storage.AddDownload(t,r,n,e.Storage.MimeTypes.Binary)),e.Log.Info("'" + t + "' downloaded"),e.send("#"),e.scrollToDownloads();}),this.Hub = new l.Hub({received:function received(t){if(null != t)if((e.View.Decoder.DecodeBase64(t),e.Downloading()))try{e.Downloader.Decode(t);}catch(t) {e.Log.Error(t),e.Status.unexpected();}else try{e.EnableDownload(e.Downloader.TryDecodeHeaderFrame(t));}catch(e) {}},stats:function stats(t){t.active?1 == t.active?e.UserStats("1 user online"):e.UserStats(t.active + " users online"):e.UserStats("0 users online");},exception:function exception(t){e.Status.error(t),e.Log.Error(t);}}),this.Status = {success:function success(t){e.View.Buffer.SetStatusRow(t,2,0);},info:function info(t){e.View.Buffer.SetStatusRow(t,7,0);},error:function error(t){e.View.Buffer.SetStatusRow(t,1,0);},unexpected:function unexpected(){e.View.Buffer.SetStatusRow("An error occurred",1,0);},warning:function warning(t){e.View.Buffer.SetStatusRow(t,3,0);},clear:function clear(){e.View.Buffer.SetStatusRow(null,0,0);}},this.OnKeyDown = function(t,r){return "Enter" != r.originalEvent.key || (e.Send(),!1);},this.ToggleConnect = _.throttle(function(){e.IsViewFocused(!0),e.Status.clear(),e.Hub.Connect().then(function(){return e.IsConnected()?e.disconnect():e.connect();})["catch"](function(t){e.Log.Error(t);});},1e3),this.ToggleReveal = _.throttle(function(){e.IsViewFocused(!0),e.View.IsRevealed(!e.View.IsRevealed());},1e3),this.Send = _.throttle(function(){if(e.IsConnected()){e.IsViewFocused(!0);var t=e.Input() || "";t.endsWith("#") || (t += "#"),e.Command(t);}},1e3),this.Command = function(t){null != t && e.IsConnected() && (e.IsViewFocused(!0),e.Downloader.Reset(),e.Status.clear(),e.Hub.Connect().then(function(){e.send(t);})["catch"](function(t){e.Log.Error(t);}));},this.Logoff = function(){e.IsConnected() && (e.IsViewFocused(!0),e.Downloader.Reset(),e.Status.clear(),e.Hub.Connect().then(function(){null != e.Postamble() && e.send(e.Postamble());})["catch"](function(t){e.Log.Error(t);}));},this.Download = function(){e.EnableDownload() && e.IsConnected() && (e.IsViewFocused(!0),e.Status.clear(),e.Hub.Connect().then(function(){e.Downloading(!0),e.send("#");})["catch"](function(t){e.Log.Error(t);}));},this.RemoveDownload = _.throttle(function(t){e.IsViewFocused(!0),e.Storage.RemoveDownloadAt(t);var r=e.Downloads();r.splice(t,1),e.Downloads(r);},1e3),this.SaveFrame = _.throttle(function(){e.IsViewFocused(!0);var t=e.View.Decoder.GetFrameAsBase64();if(null != t){var r=document.getElementById("Canvas"),n=s.SaveAsImage(e.View.Buffer,r,160,125),o=e.Storage.AddFrame(t,n);e.SavedFrames.push(o),e.FrameSlider.refresh();}},1e3),this.LoadSavedFrame = _.throttle(function(t){e.IsViewFocused(!0);var r=e.Storage.GetFrameAt(t);e.View.Decoder.Load(r.b64);},1e3),this.Clipboard = ko.observable(),this.CopySavedFrame = _.throttle(function(t){e.IsViewFocused(!0);var r=e.Storage.GetFrameAt(t);e.Clipboard(r.b64),document.getElementById("Clipboard").select(),document.execCommand("copy");},1e3),this.RemoveSavedFrame = _.throttle(function(t){e.IsViewFocused(!0),e.Storage.RemoveFrameAt(t);var r=e.SavedFrames();r.splice(t,1),e.SavedFrames(r),e.FrameSlider.refresh();},1e3),this.SaveAsImage = _.throttle(function(){e.IsViewFocused(!0);var t=document.getElementById("Canvas"),r=s.SaveAsImage(e.View.Buffer,t),n="" + e.View.Decoder.FrameNumber() + r.extension,o=e.Storage.AddDownload(n,r.size,r.b64,r.mime);e.Downloads.push(o),e.scrollToDownloads();},1e3),this.FullScreen = _.throttle(function(){return n(e,void 0,void 0,function(){return o(this,function(e){switch(e.label){case 0:return this.mainViewElement.requestFullscreen?(this.View.ShowGrid(!1),[4,this.mainViewElement.requestFullscreen()]):[3,2];case 1:e.sent(),this.IsViewFocused(!0),e.label = 2;case 2:return [2];}});});},1e3),this.Storage.Migrate(),this.Downloads(this.Storage.Downloads()),this.View.EnableFlash(this.Storage.EnableFlashing),this.View.EnableFlash.subscribe(function(t){e.Storage.EnableFlashing = t,t?s.Clock.Start():s.Clock.Stop();}),this.initGestures(),this.View.EnableFlash() && s.Clock.Start(),this.FrameSlider = $("#saved-frames").lightSlider({item:6,autoWidth:!0}),this.SavedFrames(this.Storage.Frames()),setTimeout(function(){e.FrameSlider.refresh();},0),this.Hub.Connect().then(function(){return e.Hub.Server.services();}).then(function(t){return e.Services(t),e.checkConnection(!0);})["catch"](function(){e.Log.Info("No existing connection");}),[this.View.IsRevealed,this.View.ShowGrid,this.View.EnableFlash].forEach(function(t){return t.subscribe(function(){e.IsViewFocused(!0);});});}return e.prototype.checkConnection = function(e){var t=this;return new Promise(function(r,n){t.Hub.Server.isOpen().then(function(o){o.isOpen?(t.SelectedService(o.service),t.onConnected(o),t.Log.Info("Already connected"),e && (t.Log.Info("Reloading frame. Sending '*00#'"),t.send("*00#")),r()):(t.IsConnected() && (t.Log.Warning("The session was closed due to inactivity or an error on the remote host. Please re-connect"),t.Status.warning("Session closed: inactive/remote error")),t.onDisconnected(),n());})["catch"](function(e){t.Log.Error(e),t.Status.unexpected(),t.onDisconnected(),n(e);});});},e.prototype.send = function(e){var t=this,r=u.FromKeyboardString(e);this.Log.Info("Sending '" + e + "' encoded as '" + r + "'");var n=btoa(r);this.Hub.Server.asyncWrite(n)["catch"](function(){return t.Log.Error("Send failed. Checking connection"),t.checkConnection(!1);})["catch"](function(){t.Log.Info("No existing connection");});},e.prototype.connect = function(){var e=this,t=this.SelectedService();return this.Log.Info("Connecting to " + t),this.checkConnection(!0)["catch"](function(){return e.Hub.Server.open(t).then(function(t){e.Log.Success("Connected to " + t.host + " on port " + t.port),e.onConnected(t);})["catch"](function(t){e.Log.Error(t),e.Status.unexpected();});});},e.prototype.disconnect = function(){var e=this;return this.Log.Info("Disconnecting..."),this.Hub.Server.close().then(function(){e.Log.Success("Disconnected"),e.onDisconnected();})["catch"](function(t){e.Log.Error(t),e.onDisconnected();});},e.prototype.initGestures = function(){var e=this,t=new Hammer.Manager(this.mainViewElement);t.add(new Hammer.Tap({event:"singletap",taps:1})),t.add(new Hammer.Pan({event:"panleft",direction:Hammer.DIRECTION_LEFT})),t.add(new Hammer.Pan({event:"panright",direction:Hammer.DIRECTION_RIGHT})),t.add(new Hammer.Pan({event:"pandown",direction:Hammer.DIRECTION_DOWN})),t.on("panleft",_.debounce(function(){e.IsConnected() && (e.IsTeletext()?e.Command(e.teletextCommands.ADVANCE):e.Command(e.viewdataCommands.NEXT));},500)),t.on("panright",_.debounce(function(){e.IsConnected() && (e.IsTeletext() || e.Command(e.viewdataCommands.PREVIOUS));},500)),t.on("pandown",_.debounce(function(){document.fullscreenElement && document.exitFullscreen();},500)),t.on("singletap",function(t){e.IsConnected() && e.IsTeletext() && e.Command(e.teletextCommands.HOLD);});},e.prototype.onConnected = function(e){this.Header(e.host + ":" + e.port),this.IsConnected(!0),this.Postamble(e.postamble),this.IsViewdata("Viewdata" == e.mode),this.IsTeletext("Teletext" == e.mode),this.Hub.Server.asyncRead();},e.prototype.onDisconnected = function(){this.Header(this.defaultHeader),this.IsConnected(!1),this.EnableDownload(!1),this.Postamble(null);},e.prototype.scrollToDownloads = function(){var e=this.downloadsElement.getBoundingClientRect().top + window.scrollY;window.scroll({top:e,behavior:"smooth"});},e;})();r.Main = g;},{"./Hub.js":24,"./Logger.js":25,"./Mode7.js":27,"./Mullard.js":28,"./Storage.js":29,"./SvgRenderer.js":30,"./Telesoft.js":31,"./Terminal.js":32}],34:[function(e,t,r){"use strict";r.byteLength = function(e){var t=u(e),r=t[0],n=t[1];return 3 * (r + n) / 4 - n;},r.toByteArray = function(e){var t,r,n=u(e),s=n[0],a=n[1],c=new i((function(e,t,r){return 3 * (t + r) / 4 - r;})(0,s,a)),l=0,h=a > 0?s - 4:s;for(r = 0;r < h;r += 4) t = o[e.charCodeAt(r)] << 18 | o[e.charCodeAt(r + 1)] << 12 | o[e.charCodeAt(r + 2)] << 6 | o[e.charCodeAt(r + 3)],c[l++] = t >> 16 & 255,c[l++] = t >> 8 & 255,c[l++] = 255 & t;2 === a && (t = o[e.charCodeAt(r)] << 2 | o[e.charCodeAt(r + 1)] >> 4,c[l++] = 255 & t);1 === a && (t = o[e.charCodeAt(r)] << 10 | o[e.charCodeAt(r + 1)] << 4 | o[e.charCodeAt(r + 2)] >> 2,c[l++] = t >> 8 & 255,c[l++] = 255 & t);return c;},r.fromByteArray = function(e){for(var t,r=e.length,o=r % 3,i=[],s=16383,a=0,c=r - o;a < c;a += s) i.push(l(e,a,a + s > c?c:a + s));1 === o?(t = e[r - 1],i.push(n[t >> 2] + n[t << 4 & 63] + "==")):2 === o && (t = (e[r - 2] << 8) + e[r - 1],i.push(n[t >> 10] + n[t >> 4 & 63] + n[t << 2 & 63] + "="));return i.join("");};for(var n=[],o=[],i="undefined" != typeof Uint8Array?Uint8Array:Array,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0,c=s.length;a < c;++a) n[a] = s[a],o[s.charCodeAt(a)] = a;function u(e){var t=e.length;if(t % 4 > 0)throw new Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");return -1 === r && (r = t),[r,r === t?0:4 - r % 4];}function l(e,t,r){for(var o,i,s=[],a=t;a < r;a += 3) o = (e[a] << 16 & 16711680) + (e[a + 1] << 8 & 65280) + (255 & e[a + 2]),s.push(n[(i = o) >> 18 & 63] + n[i >> 12 & 63] + n[i >> 6 & 63] + n[63 & i]);return s.join("");}o["-".charCodeAt(0)] = 62,o["_".charCodeAt(0)] = 63;},{}],35:[function(e,t,r){(function(t){(function(){ /*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */"use strict";var t=e("base64-js"),n=e("ieee754");r.Buffer = s,r.SlowBuffer = function(e){+e != e && (e = 0);return s.alloc(+e);},r.INSPECT_MAX_BYTES = 50;var o=2147483647;function i(e){if(e > o)throw new RangeError('The value "' + e + '" is invalid for option "size"');var t=new Uint8Array(e);return t.__proto__ = s.prototype,t;}function s(e,t,r){if("number" == typeof e){if("string" == typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return u(e);}return a(e,t,r);}function a(e,t,r){if("string" == typeof e)return (function(e,t){"string" == typeof t && "" !== t || (t = "utf8");if(!s.isEncoding(t))throw new TypeError("Unknown encoding: " + t);var r=0 | f(e,t),n=i(r),o=n.write(e,t);o !== r && (n = n.slice(0,o));return n;})(e,t);if(ArrayBuffer.isView(e))return l(e);if(null == e)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type " + typeof e);if(U(e,ArrayBuffer) || e && U(e.buffer,ArrayBuffer))return (function(e,t,r){if(t < 0 || e.byteLength < t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength < t + (r || 0))throw new RangeError('"length" is outside of buffer bounds');var n;n = void 0 === t && void 0 === r?new Uint8Array(e):void 0 === r?new Uint8Array(e,t):new Uint8Array(e,t,r);return n.__proto__ = s.prototype,n;})(e,t,r);if("number" == typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');var n=e.valueOf && e.valueOf();if(null != n && n !== e)return s.from(n,t,r);var o=(function(e){if(s.isBuffer(e)){var t=0 | h(e.length),r=i(t);return 0 === r.length || e.copy(r,0,0,t),r;}if(void 0 !== e.length)return "number" != typeof e.length || N(e.length)?i(0):l(e);if("Buffer" === e.type && Array.isArray(e.data))return l(e.data);})(e);if(o)return o;if("undefined" != typeof Symbol && null != Symbol.toPrimitive && "function" == typeof e[Symbol.toPrimitive])return s.from(e[Symbol.toPrimitive]("string"),t,r);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type " + typeof e);}function c(e){if("number" != typeof e)throw new TypeError('"size" argument must be of type number');if(e < 0)throw new RangeError('The value "' + e + '" is invalid for option "size"');}function u(e){return c(e),i(e < 0?0:0 | h(e));}function l(e){for(var t=e.length < 0?0:0 | h(e.length),r=i(t),n=0;n < t;n += 1) r[n] = 255 & e[n];return r;}function h(e){if(e >= o)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x" + o.toString(16) + " bytes");return 0 | e;}function f(e,t){if(s.isBuffer(e))return e.length;if(ArrayBuffer.isView(e) || U(e,ArrayBuffer))return e.byteLength;if("string" != typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type ' + typeof e);var r=e.length,n=arguments.length > 2 && !0 === arguments[2];if(!n && 0 === r)return 0;for(var o=!1;;) switch(t){case "ascii":case "latin1":case "binary":return r;case "utf8":case "utf-8":return B(e).length;case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":return 2 * r;case "hex":return r >>> 1;case "base64":return O(e).length;default:if(o)return n?-1:B(e).length;t = ("" + t).toLowerCase(),o = !0;}}function p(e,t,r){var n=!1;if(((void 0 === t || t < 0) && (t = 0),t > this.length))return "";if(((void 0 === r || r > this.length) && (r = this.length),r <= 0))return "";if((r >>>= 0) <= (t >>>= 0))return "";for(e || (e = "utf8");;) switch(e){case "hex":return H(this,t,r);case "utf8":case "utf-8":return k(this,t,r);case "ascii":return E(this,t,r);case "latin1":case "binary":return T(this,t,r);case "base64":return S(this,t,r);case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":return R(this,t,r);default:if(n)throw new TypeError("Unknown encoding: " + e);e = (e + "").toLowerCase(),n = !0;}}function g(e,t,r){var n=e[t];e[t] = e[r],e[r] = n;}function d(e,t,r,n,o){if(0 === e.length)return -1;if(("string" == typeof r?(n = r,r = 0):r > 2147483647?r = 2147483647:r < -2147483648 && (r = -2147483648),N(r = +r) && (r = o?0:e.length - 1),r < 0 && (r = e.length + r),r >= e.length)){if(o)return -1;r = e.length - 1;}else if(r < 0){if(!o)return -1;r = 0;}if(("string" == typeof t && (t = s.from(t,n)),s.isBuffer(t)))return 0 === t.length?-1:b(e,t,r,n,o);if("number" == typeof t)return t &= 255,"function" == typeof Uint8Array.prototype.indexOf?o?Uint8Array.prototype.indexOf.call(e,t,r):Uint8Array.prototype.lastIndexOf.call(e,t,r):b(e,[t],r,n,o);throw new TypeError("val must be string, number or Buffer");}function b(e,t,r,n,o){var i,s=1,a=e.length,c=t.length;if(void 0 !== n && ("ucs2" === (n = String(n).toLowerCase()) || "ucs-2" === n || "utf16le" === n || "utf-16le" === n)){if(e.length < 2 || t.length < 2)return -1;s = 2,a /= 2,c /= 2,r /= 2;}function u(e,t){return 1 === s?e[t]:e.readUInt16BE(t * s);}if(o){var l=-1;for(i = r;i < a;i++) if(u(e,i) === u(t,-1 === l?0:i - l)){if((-1 === l && (l = i),i - l + 1 === c))return l * s;}else -1 !== l && (i -= i - l),l = -1;}else for(r + c > a && (r = a - c),i = r;i >= 0;i--) {for(var h=!0,f=0;f < c;f++) if(u(e,i + f) !== u(t,f)){h = !1;break;}if(h)return i;}return -1;}function v(e,t,r,n){r = Number(r) || 0;var o=e.length - r;n?(n = Number(n)) > o && (n = o):n = o;var i=t.length;n > i / 2 && (n = i / 2);for(var s=0;s < n;++s) {var a=parseInt(t.substr(2 * s,2),16);if(N(a))return s;e[r + s] = a;}return s;}function y(e,t,r,n){return j(B(t,e.length - r),e,r,n);}function w(e,t,r,n){return j((function(e){for(var t=[],r=0;r < e.length;++r) t.push(255 & e.charCodeAt(r));return t;})(t),e,r,n);}function m(e,t,r,n){return w(e,t,r,n);}function C(e,t,r,n){return j(O(t),e,r,n);}function I(e,t,r,n){return j((function(e,t){for(var r,n,o,i=[],s=0;s < e.length && !((t -= 2) < 0);++s) n = (r = e.charCodeAt(s)) >> 8,o = r % 256,i.push(o),i.push(n);return i;})(t,e.length - r),e,r,n);}function S(e,r,n){return 0 === r && n === e.length?t.fromByteArray(e):t.fromByteArray(e.slice(r,n));}function k(e,t,r){r = Math.min(e.length,r);for(var n=[],o=t;o < r;) {var i,s,a,c,u=e[o],l=null,h=u > 239?4:u > 223?3:u > 191?2:1;if(o + h <= r)switch(h){case 1:u < 128 && (l = u);break;case 2:128 == (192 & (i = e[o + 1])) && (c = (31 & u) << 6 | 63 & i) > 127 && (l = c);break;case 3:i = e[o + 1],s = e[o + 2],128 == (192 & i) && 128 == (192 & s) && (c = (15 & u) << 12 | (63 & i) << 6 | 63 & s) > 2047 && (c < 55296 || c > 57343) && (l = c);break;case 4:i = e[o + 1],s = e[o + 2],a = e[o + 3],128 == (192 & i) && 128 == (192 & s) && 128 == (192 & a) && (c = (15 & u) << 18 | (63 & i) << 12 | (63 & s) << 6 | 63 & a) > 65535 && c < 1114112 && (l = c);}null === l?(l = 65533,h = 1):l > 65535 && (l -= 65536,n.push(l >>> 10 & 1023 | 55296),l = 56320 | 1023 & l),n.push(l),o += h;}return (function(e){var t=e.length;if(t <= L)return String.fromCharCode.apply(String,e);var r="",n=0;for(;n < t;) r += String.fromCharCode.apply(String,e.slice(n,n += L));return r;})(n);}r.kMaxLength = o,s.TYPED_ARRAY_SUPPORT = (function(){try{var e=new Uint8Array(1);return e.__proto__ = {__proto__:Uint8Array.prototype,foo:function foo(){return 42;}},42 === e.foo();}catch(e) {return !1;}})(),s.TYPED_ARRAY_SUPPORT || "undefined" == typeof console || "function" != typeof console.error || console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(s.prototype,"parent",{enumerable:!0,get:function get(){if(s.isBuffer(this))return this.buffer;}}),Object.defineProperty(s.prototype,"offset",{enumerable:!0,get:function get(){if(s.isBuffer(this))return this.byteOffset;}}),"undefined" != typeof Symbol && null != Symbol.species && s[Symbol.species] === s && Object.defineProperty(s,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),s.poolSize = 8192,s.from = function(e,t,r){return a(e,t,r);},s.prototype.__proto__ = Uint8Array.prototype,s.__proto__ = Uint8Array,s.alloc = function(e,t,r){return (function(e,t,r){return c(e),e <= 0?i(e):void 0 !== t?"string" == typeof r?i(e).fill(t,r):i(e).fill(t):i(e);})(e,t,r);},s.allocUnsafe = function(e){return u(e);},s.allocUnsafeSlow = function(e){return u(e);},s.isBuffer = function(e){return null != e && !0 === e._isBuffer && e !== s.prototype;},s.compare = function(e,t){if((U(e,Uint8Array) && (e = s.from(e,e.offset,e.byteLength)),U(t,Uint8Array) && (t = s.from(t,t.offset,t.byteLength)),!s.isBuffer(e) || !s.isBuffer(t)))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e === t)return 0;for(var r=e.length,n=t.length,o=0,i=Math.min(r,n);o < i;++o) if(e[o] !== t[o]){r = e[o],n = t[o];break;}return r < n?-1:n < r?1:0;},s.isEncoding = function(e){switch(String(e).toLowerCase()){case "hex":case "utf8":case "utf-8":case "ascii":case "latin1":case "binary":case "base64":case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":return !0;default:return !1;}},s.concat = function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0 === e.length)return s.alloc(0);var r;if(void 0 === t)for(t = 0,r = 0;r < e.length;++r) t += e[r].length;var n=s.allocUnsafe(t),o=0;for(r = 0;r < e.length;++r) {var i=e[r];if((U(i,Uint8Array) && (i = s.from(i)),!s.isBuffer(i)))throw new TypeError('"list" argument must be an Array of Buffers');i.copy(n,o),o += i.length;}return n;},s.byteLength = f,s.prototype._isBuffer = !0,s.prototype.swap16 = function(){var e=this.length;if(e % 2 != 0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t < e;t += 2) g(this,t,t + 1);return this;},s.prototype.swap32 = function(){var e=this.length;if(e % 4 != 0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t < e;t += 4) g(this,t,t + 3),g(this,t + 1,t + 2);return this;},s.prototype.swap64 = function(){var e=this.length;if(e % 8 != 0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t < e;t += 8) g(this,t,t + 7),g(this,t + 1,t + 6),g(this,t + 2,t + 5),g(this,t + 3,t + 4);return this;},s.prototype.toString = function(){var e=this.length;return 0 === e?"":0 === arguments.length?k(this,0,e):p.apply(this,arguments);},s.prototype.toLocaleString = s.prototype.toString,s.prototype.equals = function(e){if(!s.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this === e || 0 === s.compare(this,e);},s.prototype.inspect = function(){var e="",t=r.INSPECT_MAX_BYTES;return e = this.toString("hex",0,t).replace(/(.{2})/g,"$1 ").trim(),this.length > t && (e += " ... "),"<Buffer " + e + ">";},s.prototype.compare = function(e,t,r,n,o){if((U(e,Uint8Array) && (e = s.from(e,e.offset,e.byteLength)),!s.isBuffer(e)))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type ' + typeof e);if((void 0 === t && (t = 0),void 0 === r && (r = e?e.length:0),void 0 === n && (n = 0),void 0 === o && (o = this.length),t < 0 || r > e.length || n < 0 || o > this.length))throw new RangeError("out of range index");if(n >= o && t >= r)return 0;if(n >= o)return -1;if(t >= r)return 1;if(this === e)return 0;for(var i=(o >>>= 0) - (n >>>= 0),a=(r >>>= 0) - (t >>>= 0),c=Math.min(i,a),u=this.slice(n,o),l=e.slice(t,r),h=0;h < c;++h) if(u[h] !== l[h]){i = u[h],a = l[h];break;}return i < a?-1:a < i?1:0;},s.prototype.includes = function(e,t,r){return -1 !== this.indexOf(e,t,r);},s.prototype.indexOf = function(e,t,r){return d(this,e,t,r,!0);},s.prototype.lastIndexOf = function(e,t,r){return d(this,e,t,r,!1);},s.prototype.write = function(e,t,r,n){if(void 0 === t)n = "utf8",r = this.length,t = 0;else if(void 0 === r && "string" == typeof t)n = t,r = this.length,t = 0;else {if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t >>>= 0,isFinite(r)?(r >>>= 0,void 0 === n && (n = "utf8")):(n = r,r = void 0);}var o=this.length - t;if(((void 0 === r || r > o) && (r = o),e.length > 0 && (r < 0 || t < 0) || t > this.length))throw new RangeError("Attempt to write outside buffer bounds");n || (n = "utf8");for(var i=!1;;) switch(n){case "hex":return v(this,e,t,r);case "utf8":case "utf-8":return y(this,e,t,r);case "ascii":return w(this,e,t,r);case "latin1":case "binary":return m(this,e,t,r);case "base64":return C(this,e,t,r);case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":return I(this,e,t,r);default:if(i)throw new TypeError("Unknown encoding: " + n);n = ("" + n).toLowerCase(),i = !0;}},s.prototype.toJSON = function(){return {type:"Buffer",data:Array.prototype.slice.call(this._arr || this,0)};};var L=4096;function E(e,t,r){var n="";r = Math.min(e.length,r);for(var o=t;o < r;++o) n += String.fromCharCode(127 & e[o]);return n;}function T(e,t,r){var n="";r = Math.min(e.length,r);for(var o=t;o < r;++o) n += String.fromCharCode(e[o]);return n;}function H(e,t,r){var n=e.length;(!t || t < 0) && (t = 0),(!r || r < 0 || r > n) && (r = n);for(var o="",i=t;i < r;++i) o += F(e[i]);return o;}function R(e,t,r){for(var n=e.slice(t,r),o="",i=0;i < n.length;i += 2) o += String.fromCharCode(n[i] + 256 * n[i + 1]);return o;}function x(e,t,r){if(e % 1 != 0 || e < 0)throw new RangeError("offset is not uint");if(e + t > r)throw new RangeError("Trying to access beyond buffer length");}function _(e,t,r,n,o,i){if(!s.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t > o || t < i)throw new RangeError('"value" argument is out of bounds');if(r + n > e.length)throw new RangeError("Index out of range");}function P(e,t,r,n,o,i){if(r + n > e.length)throw new RangeError("Index out of range");if(r < 0)throw new RangeError("Index out of range");}function D(e,t,r,o,i){return t = +t,r >>>= 0,i || P(e,0,r,4),n.write(e,t,r,o,23,4),r + 4;}function A(e,t,r,o,i){return t = +t,r >>>= 0,i || P(e,0,r,8),n.write(e,t,r,o,52,8),r + 8;}s.prototype.slice = function(e,t){var r=this.length;(e = ~ ~e) < 0?(e += r) < 0 && (e = 0):e > r && (e = r),(t = void 0 === t?r:~ ~t) < 0?(t += r) < 0 && (t = 0):t > r && (t = r),t < e && (t = e);var n=this.subarray(e,t);return n.__proto__ = s.prototype,n;},s.prototype.readUIntLE = function(e,t,r){e >>>= 0,t >>>= 0,r || x(e,t,this.length);for(var n=this[e],o=1,i=0;++i < t && (o *= 256);) n += this[e + i] * o;return n;},s.prototype.readUIntBE = function(e,t,r){e >>>= 0,t >>>= 0,r || x(e,t,this.length);for(var n=this[e + --t],o=1;t > 0 && (o *= 256);) n += this[e + --t] * o;return n;},s.prototype.readUInt8 = function(e,t){return e >>>= 0,t || x(e,1,this.length),this[e];},s.prototype.readUInt16LE = function(e,t){return e >>>= 0,t || x(e,2,this.length),this[e] | this[e + 1] << 8;},s.prototype.readUInt16BE = function(e,t){return e >>>= 0,t || x(e,2,this.length),this[e] << 8 | this[e + 1];},s.prototype.readUInt32LE = function(e,t){return e >>>= 0,t || x(e,4,this.length),(this[e] | this[e + 1] << 8 | this[e + 2] << 16) + 16777216 * this[e + 3];},s.prototype.readUInt32BE = function(e,t){return e >>>= 0,t || x(e,4,this.length),16777216 * this[e] + (this[e + 1] << 16 | this[e + 2] << 8 | this[e + 3]);},s.prototype.readIntLE = function(e,t,r){e >>>= 0,t >>>= 0,r || x(e,t,this.length);for(var n=this[e],o=1,i=0;++i < t && (o *= 256);) n += this[e + i] * o;return n >= (o *= 128) && (n -= Math.pow(2,8 * t)),n;},s.prototype.readIntBE = function(e,t,r){e >>>= 0,t >>>= 0,r || x(e,t,this.length);for(var n=t,o=1,i=this[e + --n];n > 0 && (o *= 256);) i += this[e + --n] * o;return i >= (o *= 128) && (i -= Math.pow(2,8 * t)),i;},s.prototype.readInt8 = function(e,t){return e >>>= 0,t || x(e,1,this.length),128 & this[e]?-1 * (255 - this[e] + 1):this[e];},s.prototype.readInt16LE = function(e,t){e >>>= 0,t || x(e,2,this.length);var r=this[e] | this[e + 1] << 8;return 32768 & r?4294901760 | r:r;},s.prototype.readInt16BE = function(e,t){e >>>= 0,t || x(e,2,this.length);var r=this[e + 1] | this[e] << 8;return 32768 & r?4294901760 | r:r;},s.prototype.readInt32LE = function(e,t){return e >>>= 0,t || x(e,4,this.length),this[e] | this[e + 1] << 8 | this[e + 2] << 16 | this[e + 3] << 24;},s.prototype.readInt32BE = function(e,t){return e >>>= 0,t || x(e,4,this.length),this[e] << 24 | this[e + 1] << 16 | this[e + 2] << 8 | this[e + 3];},s.prototype.readFloatLE = function(e,t){return e >>>= 0,t || x(e,4,this.length),n.read(this,e,!0,23,4);},s.prototype.readFloatBE = function(e,t){return e >>>= 0,t || x(e,4,this.length),n.read(this,e,!1,23,4);},s.prototype.readDoubleLE = function(e,t){return e >>>= 0,t || x(e,8,this.length),n.read(this,e,!0,52,8);},s.prototype.readDoubleBE = function(e,t){return e >>>= 0,t || x(e,8,this.length),n.read(this,e,!1,52,8);},s.prototype.writeUIntLE = function(e,t,r,n){(e = +e,t >>>= 0,r >>>= 0,n) || _(this,e,t,r,Math.pow(2,8 * r) - 1,0);var o=1,i=0;for(this[t] = 255 & e;++i < r && (o *= 256);) this[t + i] = e / o & 255;return t + r;},s.prototype.writeUIntBE = function(e,t,r,n){(e = +e,t >>>= 0,r >>>= 0,n) || _(this,e,t,r,Math.pow(2,8 * r) - 1,0);var o=r - 1,i=1;for(this[t + o] = 255 & e;--o >= 0 && (i *= 256);) this[t + o] = e / i & 255;return t + r;},s.prototype.writeUInt8 = function(e,t,r){return e = +e,t >>>= 0,r || _(this,e,t,1,255,0),this[t] = 255 & e,t + 1;},s.prototype.writeUInt16LE = function(e,t,r){return e = +e,t >>>= 0,r || _(this,e,t,2,65535,0),this[t] = 255 & e,this[t + 1] = e >>> 8,t + 2;},s.prototype.writeUInt16BE = function(e,t,r){return e = +e,t >>>= 0,r || _(this,e,t,2,65535,0),this[t] = e >>> 8,this[t + 1] = 255 & e,t + 2;},s.prototype.writeUInt32LE = function(e,t,r){return e = +e,t >>>= 0,r || _(this,e,t,4,4294967295,0),this[t + 3] = e >>> 24,this[t + 2] = e >>> 16,this[t + 1] = e >>> 8,this[t] = 255 & e,t + 4;},s.prototype.writeUInt32BE = function(e,t,r){return e = +e,t >>>= 0,r || _(this,e,t,4,4294967295,0),this[t] = e >>> 24,this[t + 1] = e >>> 16,this[t + 2] = e >>> 8,this[t + 3] = 255 & e,t + 4;},s.prototype.writeIntLE = function(e,t,r,n){if((e = +e,t >>>= 0,!n)){var o=Math.pow(2,8 * r - 1);_(this,e,t,r,o - 1,-o);}var i=0,s=1,a=0;for(this[t] = 255 & e;++i < r && (s *= 256);) e < 0 && 0 === a && 0 !== this[t + i - 1] && (a = 1),this[t + i] = (e / s >> 0) - a & 255;return t + r;},s.prototype.writeIntBE = function(e,t,r,n){if((e = +e,t >>>= 0,!n)){var o=Math.pow(2,8 * r - 1);_(this,e,t,r,o - 1,-o);}var i=r - 1,s=1,a=0;for(this[t + i] = 255 & e;--i >= 0 && (s *= 256);) e < 0 && 0 === a && 0 !== this[t + i + 1] && (a = 1),this[t + i] = (e / s >> 0) - a & 255;return t + r;},s.prototype.writeInt8 = function(e,t,r){return e = +e,t >>>= 0,r || _(this,e,t,1,127,-128),e < 0 && (e = 255 + e + 1),this[t] = 255 & e,t + 1;},s.prototype.writeInt16LE = function(e,t,r){return e = +e,t >>>= 0,r || _(this,e,t,2,32767,-32768),this[t] = 255 & e,this[t + 1] = e >>> 8,t + 2;},s.prototype.writeInt16BE = function(e,t,r){return e = +e,t >>>= 0,r || _(this,e,t,2,32767,-32768),this[t] = e >>> 8,this[t + 1] = 255 & e,t + 2;},s.prototype.writeInt32LE = function(e,t,r){return e = +e,t >>>= 0,r || _(this,e,t,4,2147483647,-2147483648),this[t] = 255 & e,this[t + 1] = e >>> 8,this[t + 2] = e >>> 16,this[t + 3] = e >>> 24,t + 4;},s.prototype.writeInt32BE = function(e,t,r){return e = +e,t >>>= 0,r || _(this,e,t,4,2147483647,-2147483648),e < 0 && (e = 4294967295 + e + 1),this[t] = e >>> 24,this[t + 1] = e >>> 16,this[t + 2] = e >>> 8,this[t + 3] = 255 & e,t + 4;},s.prototype.writeFloatLE = function(e,t,r){return D(this,e,t,!0,r);},s.prototype.writeFloatBE = function(e,t,r){return D(this,e,t,!1,r);},s.prototype.writeDoubleLE = function(e,t,r){return A(this,e,t,!0,r);},s.prototype.writeDoubleBE = function(e,t,r){return A(this,e,t,!1,r);},s.prototype.copy = function(e,t,r,n){if(!s.isBuffer(e))throw new TypeError("argument should be a Buffer");if((r || (r = 0),n || 0 === n || (n = this.length),t >= e.length && (t = e.length),t || (t = 0),n > 0 && n < r && (n = r),n === r))return 0;if(0 === e.length || 0 === this.length)return 0;if(t < 0)throw new RangeError("targetStart out of bounds");if(r < 0 || r >= this.length)throw new RangeError("Index out of range");if(n < 0)throw new RangeError("sourceEnd out of bounds");n > this.length && (n = this.length),e.length - t < n - r && (n = e.length - t + r);var o=n - r;if(this === e && "function" == typeof Uint8Array.prototype.copyWithin)this.copyWithin(t,r,n);else if(this === e && r < t && t < n)for(var i=o - 1;i >= 0;--i) e[i + t] = this[i + r];else Uint8Array.prototype.set.call(e,this.subarray(r,n),t);return o;},s.prototype.fill = function(e,t,r,n){if("string" == typeof e){if(("string" == typeof t?(n = t,t = 0,r = this.length):"string" == typeof r && (n = r,r = this.length),void 0 !== n && "string" != typeof n))throw new TypeError("encoding must be a string");if("string" == typeof n && !s.isEncoding(n))throw new TypeError("Unknown encoding: " + n);if(1 === e.length){var o=e.charCodeAt(0);("utf8" === n && o < 128 || "latin1" === n) && (e = o);}}else "number" == typeof e && (e &= 255);if(t < 0 || this.length < t || this.length < r)throw new RangeError("Out of range index");if(r <= t)return this;var i;if((t >>>= 0,r = void 0 === r?this.length:r >>> 0,e || (e = 0),"number" == typeof e))for(i = t;i < r;++i) this[i] = e;else {var a=s.isBuffer(e)?e:s.from(e,n),c=a.length;if(0 === c)throw new TypeError('The value "' + e + '" is invalid for argument "value"');for(i = 0;i < r - t;++i) this[i + t] = a[i % c];}return this;};var M=/[^+/0-9A-Za-z-_]/g;function F(e){return e < 16?"0" + e.toString(16):e.toString(16);}function B(e,t){var r;t = t || 1 / 0;for(var n=e.length,o=null,i=[],s=0;s < n;++s) {if((r = e.charCodeAt(s)) > 55295 && r < 57344){if(!o){if(r > 56319){(t -= 3) > -1 && i.push(239,191,189);continue;}if(s + 1 === n){(t -= 3) > -1 && i.push(239,191,189);continue;}o = r;continue;}if(r < 56320){(t -= 3) > -1 && i.push(239,191,189),o = r;continue;}r = 65536 + (o - 55296 << 10 | r - 56320);}else o && (t -= 3) > -1 && i.push(239,191,189);if((o = null,r < 128)){if((t -= 1) < 0)break;i.push(r);}else if(r < 2048){if((t -= 2) < 0)break;i.push(r >> 6 | 192,63 & r | 128);}else if(r < 65536){if((t -= 3) < 0)break;i.push(r >> 12 | 224,r >> 6 & 63 | 128,63 & r | 128);}else {if(!(r < 1114112))throw new Error("Invalid code point");if((t -= 4) < 0)break;i.push(r >> 18 | 240,r >> 12 & 63 | 128,r >> 6 & 63 | 128,63 & r | 128);}}return i;}function O(e){return t.toByteArray((function(e){if((e = (e = e.split("=")[0]).trim().replace(M,"")).length < 2)return "";for(;e.length % 4 != 0;) e += "=";return e;})(e));}function j(e,t,r,n){for(var o=0;o < n && !(o + r >= t.length || o >= e.length);++o) t[o + r] = e[o];return o;}function U(e,t){return e instanceof t || null != e && null != e.constructor && null != e.constructor.name && e.constructor.name === t.name;}function N(e){return e != e;}}).call(this);}).call(this,e("buffer").Buffer);},{"base64-js":34,buffer:35,ieee754:36}],36:[function(e,t,r){ /*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */r.read = function(e,t,r,n,o){var i,s,a=8 * o - n - 1,c=(1 << a) - 1,u=c >> 1,l=-7,h=r?o - 1:0,f=r?-1:1,p=e[t + h];for(h += f,i = p & (1 << -l) - 1,p >>= -l,l += a;l > 0;i = 256 * i + e[t + h],h += f,l -= 8);for(s = i & (1 << -l) - 1,i >>= -l,l += n;l > 0;s = 256 * s + e[t + h],h += f,l -= 8);if(0 === i)i = 1 - u;else {if(i === c)return s?NaN:1 / 0 * (p?-1:1);s += Math.pow(2,n),i -= u;}return (p?-1:1) * s * Math.pow(2,i - n);},r.write = function(e,t,r,n,o,i){var s,a,c,u=8 * i - o - 1,l=(1 << u) - 1,h=l >> 1,f=23 === o?Math.pow(2,-24) - Math.pow(2,-77):0,p=n?0:i - 1,g=n?1:-1,d=t < 0 || 0 === t && 1 / t < 0?1:0;for(t = Math.abs(t),isNaN(t) || t === 1 / 0?(a = isNaN(t)?1:0,s = l):(s = Math.floor(Math.log(t) / Math.LN2),t * (c = Math.pow(2,-s)) < 1 && (s--,c *= 2),(t += s + h >= 1?f / c:f * Math.pow(2,1 - h)) * c >= 2 && (s++,c /= 2),s + h >= l?(a = 0,s = l):s + h >= 1?(a = (t * c - 1) * Math.pow(2,o),s += h):(a = t * Math.pow(2,h - 1) * Math.pow(2,o),s = 0));o >= 8;e[r + p] = 255 & a,p += g,a /= 256,o -= 8);for(s = s << o | a,u += o;u > 0;e[r + p] = 255 & s,p += g,s /= 256,u -= 8);e[r + p - g] |= 128 * d;};},{}],37:[function(e,t,r){var n,o,i=t.exports = {};function s(){throw new Error("setTimeout has not been defined");}function a(){throw new Error("clearTimeout has not been defined");}function c(e){if(n === setTimeout)return setTimeout(e,0);if((n === s || !n) && setTimeout)return n = setTimeout,setTimeout(e,0);try{return n(e,0);}catch(t) {try{return n.call(null,e,0);}catch(t) {return n.call(this,e,0);}}}!(function(){try{n = "function" == typeof setTimeout?setTimeout:s;}catch(e) {n = s;}try{o = "function" == typeof clearTimeout?clearTimeout:a;}catch(e) {o = a;}})();var u,l=[],h=!1,f=-1;function p(){h && u && (h = !1,u.length?l = u.concat(l):f = -1,l.length && g());}function g(){if(!h){var e=c(p);h = !0;for(var t=l.length;t;) {for(u = l,l = [];++f < t;) u && u[f].run();f = -1,t = l.length;}u = null,h = !1,(function(e){if(o === clearTimeout)return clearTimeout(e);if((o === a || !o) && clearTimeout)return o = clearTimeout,clearTimeout(e);try{o(e);}catch(t) {try{return o.call(null,e);}catch(t) {return o.call(this,e);}}})(e);}}function d(e,t){this.fun = e,this.array = t;}function b(){}i.nextTick = function(e){var t=new Array(arguments.length - 1);if(arguments.length > 1)for(var r=1;r < arguments.length;r++) t[r - 1] = arguments[r];l.push(new d(e,t)),1 !== l.length || h || c(g);},d.prototype.run = function(){this.fun.apply(null,this.array);},i.title = "browser",i.browser = !0,i.env = {},i.argv = [],i.version = "",i.versions = {},i.on = b,i.addListener = b,i.once = b,i.off = b,i.removeListener = b,i.removeAllListeners = b,i.emit = b,i.prependListener = b,i.prependOnceListener = b,i.listeners = function(e){return [];},i.binding = function(e){throw new Error("process.binding is not supported");},i.cwd = function(){return "/";},i.chdir = function(e){throw new Error("process.chdir is not supported");},i.umask = function(){return 0;};},{}]},{},[26]); //# sourceMappingURL=main.bundle.js.map

